<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Veritas Guard | Sealed Risk Engine</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap');
:root{
  --bg:#020408; --surface:#0a0e14; --border:#1a222d;
  --accent:#00f2ff; --accent2:#ff2d55; --accent3:#00ff88;
  --text:#ffffff; --muted:#8899a6;
  --v0:#00ff88; --v1:#ffb800; --v2:#ff6b00; --v3:#ff2d55;
}
*{box-sizing:border-box; margin:0; padding:0; -webkit-tap-highlight-color:transparent;}
body{background:var(--bg); color:var(--text); font-family:'Syne',sans-serif; min-height:100vh; line-height:1.5;}

/* SUNLIGHT OPTIMIZATION */
#warning-bar{position:fixed; top:0; width:100%; z-index:1000; background:rgba(255,45,85,0.15); border-bottom:1px solid var(--accent2); padding:10px 0; backdrop-filter:blur(15px); font-family:'Space Mono',monospace; font-size:12px;}
#warn-text{display:block; white-space:nowrap; animation:marquee 15s linear infinite;}
@keyframes marquee{0%{transform:translateX(100%)} 100%{transform:translateX(-100%)}}

#app{max-width:480px; margin:0 auto; padding:80px 16px 40px;}
.logo-text{font-size:28px; font-weight:800; background:linear-gradient(90deg, var(--accent), #fff); -webkit-background-clip:text; -webkit-text-fill-color:transparent; text-shadow:0 0 15px rgba(0,242,255,0.4);}

.stats-bar{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin:20px 0; background:var(--surface); border:1px solid var(--border); padding:15px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.5);}
.stat-val{font-family:'Space Mono',monospace; font-size:18px; color:var(--accent); font-weight:700;}
.stat-label{font-size:9px; color:var(--muted); text-transform:uppercase; letter-spacing:1px;}

.card{background:var(--surface); border:1px solid var(--border); border-radius:16px; padding:24px; box-shadow:0 20px 40px rgba(0,0,0,0.4); margin-bottom:15px;}
.lang-toggle{display:flex; gap:8px; margin-bottom:20px;}
.lang-btn{flex:1; padding:12px; background:rgba(255,255,255,0.03); border:1px solid var(--border); border-radius:8px; color:var(--muted); font-family:'Space Mono',monospace; cursor:pointer; transition:0.3s;}
.lang-btn.active{border-color:var(--accent); color:var(--accent); background:rgba(0,242,255,0.1); box-shadow:0 0 15px rgba(0,242,255,0.2);}

textarea{width:100%; height:120px; background:var(--bg); border:1px solid var(--border); border-radius:10px; color:#fff; padding:15px; font-family:'Space Mono',monospace; font-size:14px; margin:10px 0; resize:none;}
textarea:focus{border-color:var(--accent); box-shadow:0 0 10px rgba(0,242,255,0.1); outline:none;}

#analyze-btn{width:100%; padding:18px; background:linear-gradient(135deg, var(--accent), #0066ff); border:none; border-radius:10px; color:#000; font-weight:800; font-size:16px; cursor:pointer; transition:0.3s; text-transform:uppercase;}
#analyze-btn:active{transform:scale(0.98);}

/* RESULTS POLISH */
#result-card{display:none; background:var(--surface); border:1px solid var(--border); border-radius:16px; margin-top:15px; overflow:hidden; animation:slideUp 0.4s ease-out;}
@keyframes slideUp{from{opacity:0; transform:translateY(20px)} to{opacity:1; transform:translateY(0)}}

.result-header{padding:20px; display:flex; align-items:center; gap:15px;}
.verdict-icon{width:56px; height:56px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:28px; box-shadow:inset 0 0 20px rgba(0,0,0,0.2);}

.conf-bar{height:10px; background:rgba(255,255,255,0.05); border-radius:5px; margin:10px 0; overflow:hidden;}
.conf-fill{height:100%; width:0; transition:width 1.2s cubic-bezier(0.2, 0.8, 0.2, 1);}

.trace-panel{padding:15px; background:rgba(0,0,0,0.2); border-top:1px solid var(--border); margin-top:10px;}
.trace-title{font-family:'Space Mono',monospace; font-size:10px; color:var(--muted); margin-bottom:8px; display:flex; justify-content:space-between;}
.integrity-badge{font-size:9px; background:var(--v0); color:#000; padding:2px 6px; border-radius:4px; font-weight:800;}

.share-btn{flex:1; padding:12px; background:transparent; border:1px solid var(--border); border-radius:8px; color:var(--text); font-family:'Space Mono',monospace; font-size:12px; cursor:pointer;}
.share-btn.primary{background:var(--accent); color:#000; font-weight:700; border:none;}

footer{text-align:center; padding:30px; font-size:10px; color:var(--muted); font-family:'Space Mono',monospace;}
</style>
</head>
<body>

<div id="warning-bar"><span id="warn-text"></span></div>

<div id="app">
  <div class="header">
    <div class="logo">
      <div class="logo-icon">üõ°Ô∏è</div>
      <div class="logo-text">Veritas Guard</div>
    </div>
    <div class="tagline" id="tagline-text"></div>
  </div>

  <div class="stats-bar">
    <div class="stat"><div class="stat-val" id="stat-scanned">0</div><div class="stat-label" id="lbl-scanned"></div></div>
    <div class="stat"><div class="stat-val" id="stat-flagged">0</div><div class="stat-label" id="lbl-flagged"></div></div>
    <div class="stat"><div class="stat-val">v1.1</div><div class="stat-label">Sealed</div></div>
  </div>

  <div class="card">
    <div class="lang-toggle">
      <button class="lang-btn" id="btn-en">ENGLISH</button>
      <button class="lang-btn" id="btn-hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    </div>
    <textarea id="input-text" spellcheck="false"></textarea>
    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <button id="clear-btn" style="background:none; border:none; color:var(--accent2); font-size:12px; cursor:pointer; font-family:'Space Mono'">‚úï CLEAR</button>
        <span style="font-size:10px; color:var(--muted); font-family:'Space Mono'"><span id="char-val">0</span>/1000</span>
    </div>
    <button id="analyze-btn"><span id="btn-text"></span></button>
  </div>

  <div id="result-card"></div>
  <footer>PRODUCED BY <span>VERITAS ENGINE</span> ¬∑ OPEN INTEGRITY PROJECT</footer>
</div>

<script>
const ENGINE_URL = "https://api.veritasengine.in/decide";
let lang = localStorage.getItem('vg_lang') || 'en';
let scanCount = 0, flagCount = 0, lastResult = null, lastInput = '';

const T = {
  en: {
    warn: "‚ö† This tool analyzes risk patterns. Final responsibility remains with the user.",
    tagline: "EXPLAIN RISK ¬∑ DON'T DEMAND TRUST",
    placeholder: "Paste suspected message or link...",
    btnText: "‚ö° ANALYZE SIGNALS", analyzing: "SEALING DATA...",
    scanned: "Scanned", flagged: "Flagged",
    confLabel: "ENGINE CONFIDENCE", reasonsLabel: "RULES FIRED",
    verdictLabel: ["GENUINE","ATTENTION","SUSPICIOUS","FRAUD LIKELY"],
    verdictDesc: ["Safe to proceed","Stay alert","Multiple risks","High risk - Stop"],
    verdictEmoji: ["‚úÖ","‚ö†Ô∏è","üî∂","üö®"],
    shareTitle: "AUDIT EXPORT", btnCopy: "Copy", btnPdf: "Audit PDF", btnShare: "Share"
  },
  hi: {
    warn: "‚ö† ‡§Ø‡§π ‡§ü‡•Ç‡§≤ ‡§ï‡•á‡§µ‡§≤ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§º‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§Ü‡§™‡§ï‡•Ä ‡§π‡•à‡•§",
    tagline: "‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Æ‡§ù‡•á‡§Ç ¬∑ ‡§≠‡§∞‡•ã‡§∏‡§æ ‡§Æ‡§§ ‡§Æ‡§æ‡§Ç‡§ó‡•á‡§Ç",
    placeholder: "‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§Ø‡§π‡§æ‡§Å ‡§ö‡§ø‡§™‡§ï‡§æ‡§è‡§Å...",
    btnText: "‚ö° ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç", analyzing: "‡§°‡•á‡§ü‡§æ ‡§∏‡•Ä‡§≤ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
    scanned: "‡§ú‡§æ‡§Ç‡§ö‡•á ‡§ó‡§è", flagged: "‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß",
    confLabel: "‡§á‡§Ç‡§ú‡§® ‡§∏‡•ç‡§ï‡•ã‡§∞", reasonsLabel: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ø‡§Ø‡§Æ",
    verdictLabel: ["‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§","‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç","‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß","‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä"],
    verdictDesc: ["‡§Ü‡§ó‡•á ‡§¨‡•ù ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç","‡§∏‡§§‡§∞‡•ç‡§ï ‡§∞‡§π‡•á‡§Ç","‡§ï‡§à ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§Æ‡§ø‡§≤‡•á","‡§ñ‡§§‡§∞‡§æ - ‡§∞‡•Å‡§ï‡•á‡§Ç"],
    verdictEmoji: ["‚úÖ","‚ö†Ô∏è","üî∂","üö®"],
    shareTitle: "‡§ë‡§°‡§ø‡§ü ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü", btnCopy: "‡§ï‡•â‡§™‡•Ä", btnPdf: "PDF ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü", btnShare: "‡§∂‡•á‡§Ø‡§∞"
  }
};

async function callEngine(txt) {
  try {
    const res = await fetch(ENGINE_URL, {
      method: "POST", headers: {"Content-Type":"application/json"},
      body: JSON.stringify({input: txt})
    });
    return await res.json();
  } catch(e) { return null; }
}

function applyLang() {
  const t = T[lang];
  document.getElementById('warn-text').textContent = t.warn;
  document.getElementById('tagline-text').textContent = t.tagline;
  document.getElementById('input-text').placeholder = t.placeholder;
  document.getElementById('btn-text').textContent = t.btnText;
  document.getElementById('lbl-scanned').textContent = t.scanned;
  document.getElementById('lbl-flagged').textContent = t.flagged;
  document.getElementById('btn-en').classList.toggle('active', lang==='en');
  document.getElementById('btn-hi').classList.toggle('active', lang==='hi');
}

document.addEventListener("DOMContentLoaded", () => {
  applyLang();
  document.getElementById('btn-en').onclick = () => { lang='en'; applyLang(); };
  document.getElementById('btn-hi').onclick = () => { lang='hi'; applyLang(); };
  document.getElementById('input-text').oninput = (e) => document.getElementById('char-val').textContent = e.target.value.length;
  document.getElementById('clear-btn').onclick = () => { document.getElementById('input-text').value=''; document.getElementById('result-card').style.display='none'; };

  document.getElementById('analyze-btn').onclick = async () => {
    const text = document.getElementById('input-text').value.trim();
    if(!text) return;
    const btn = document.getElementById('analyze-btn');
    btn.classList.add('loading');
    document.getElementById('btn-text').textContent = T[lang].analyzing;
    
    const r = await callEngine(text);
    btn.classList.remove('loading');
    document.getElementById('btn-text').textContent = T[lang].btnText;
    
    if(!r) { alert("Engine unreachable"); return; }
    scanCount++; if(r.decision >= 2) flagCount++;
    document.getElementById('stat-scanned').textContent = scanCount;
    document.getElementById('stat-flagged').textContent = flagCount;
    lastResult = r; lastInput = text;
    showResult(r);
  };
});

function showResult(r) {
  const v = r.decision; const t = T[lang];
  const rc = document.getElementById('result-card');
  const reasons = (r.fired_rules || []).map(rule => `<span style="display:inline-block; margin:2px; padding:4px 8px; border-radius:4px; font-size:10px; background:rgba(255,255,255,0.05); color:var(--v${v}); border:1px solid var(--v${v})">${rule}</span>`).join('');
  
  rc.innerHTML = `
    <div class="result-header" style="background:rgba(var(--bg),0.5); border-bottom:1px solid var(--border)">
      <div class="verdict-icon" style="background:var(--v${v})">${t.verdictEmoji[v]}</div>
      <div>
        <h3 style="color:var(--v${v})">${t.verdictLabel[v]}</h3>
        <p style="font-size:11px; color:var(--muted)">${t.verdictDesc[v]}</p>
      </div>
    </div>
    <div style="padding:20px">
      <div style="display:flex; justify-content:space-between; font-size:10px; font-family:'Space Mono'">
        <span>${t.confLabel}</span><span style="color:var(--v${v})">${r.confidence}%</span>
      </div>
      <div class="conf-bar"><div class="conf-fill" style="width:${r.confidence}%; background:var(--v${v})"></div></div>
      <div style="margin-top:15px">
        <div style="font-size:10px; color:var(--muted); margin-bottom:5px">${t.reasonsLabel}</div>
        ${reasons}
      </div>
    </div>
    <div class="trace-panel">
      <div class="trace-title"><span>ENGINE PROOF (SHA256)</span><span class="integrity-badge">SEALED OK</span></div>
      <div style="font-family:'Space Mono'; font-size:9px; color:var(--accent); word-break:break-all">${r.hash}</div>
    </div>
    <div style="padding:15px; display:flex; gap:10px">
        <button class="share-btn primary" onclick="shareReport()">${t.btnShare}</button>
        <button class="share-btn" onclick="copyReport()">${t.btnCopy}</button>
    </div>
  `;
  rc.style.display = 'block';
  rc.scrollIntoView({behavior:'smooth'});
}

function shareReport() {
    const t = T[lang];
    const report = `VERITAS GUARD REPORT\nVerdict: ${t.verdictLabel[lastResult.decision]}\nConfidence: ${lastResult.confidence}%\nHash: ${lastResult.hash}\nMessage: ${lastInput}`;
    if(navigator.share) navigator.share({text: report});
}
function copyReport() {
    navigator.clipboard.writeText(lastInput);
    alert(lang==='hi'?'‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ!':'Copied!');
}
</script>
</body>
</html>
