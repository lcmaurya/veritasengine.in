<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Veritas Guard ‚Äî Risk Awareness Tool</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Outfit:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#08000f;--surface:#11001f;--surface2:#1a0032;
  --border:#3a1660;--border2:#5c2a96;
  --purple:#8b5cf6;--purple2:#7c3aed;--purple3:#a78bfa;
  --accent:#00ffd5;--white:#f0e8ff;--muted:rgba(240,232,255,0.55);
  --v0:#6366f1;--v1:#22c55e;--v2:#fb923c;--v3:#f87171;
  --glow:0 0 24px rgba(139,92,246,0.35);
}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--white);font-family:'Outfit',sans-serif;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(139,92,246,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(139,92,246,.03) 1px,transparent 1px);background-size:28px 28px;pointer-events:none;z-index:0}
body::after{content:'';position:fixed;width:600px;height:600px;background:radial-gradient(circle,rgba(124,58,237,.12) 0%,transparent 70%);top:-150px;right:-150px;pointer-events:none;z-index:0}
#app{position:relative;z-index:1;max-width:500px;margin:0 auto;padding:14px 12px 60px}

/* MARQUEE */
#warn-bar{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(124,58,237,.25);border-bottom:1px solid var(--border2);padding:5px 0;overflow:hidden;backdrop-filter:blur(12px)}
#warn-text{display:inline-block;white-space:nowrap;font-family:'IBM Plex Mono',monospace;font-size:11px;color:#c4b5fd;animation:marquee 28s linear infinite;padding-left:100%}
@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-200%)}}

/* HEADER */
.header{text-align:center;padding:48px 0 16px}
.logo-wrap{display:inline-flex;align-items:center;gap:10px;margin-bottom:5px}
.logo-icon{width:42px;height:42px;background:linear-gradient(135deg,var(--purple2),#4c1d95);border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:20px;box-shadow:var(--glow)}
.logo-name{font-size:26px;font-weight:900;letter-spacing:-0.5px;background:linear-gradient(135deg,#a78bfa,#f0e8ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.tagline{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase}

/* ENGINE BADGE ‚Äî disappears if not verified */
.engine-badge{display:inline-flex;align-items:center;gap:6px;margin-top:8px;padding:4px 12px;background:rgba(0,255,213,.08);border:1px solid rgba(0,255,213,.25);border-radius:20px;font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--accent);cursor:pointer}
.engine-badge .dot{width:6px;height:6px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite}
.engine-badge.unverified{background:rgba(248,113,113,.08);border-color:rgba(248,113,113,.25);color:#f87171}
.engine-badge.unverified .dot{background:#f87171}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

/* TRUST BADGE ‚Äî hard-locked indicator */
#trust-badge{display:flex;align-items:center;justify-content:center;gap:6px;margin-top:6px;padding:4px 14px;background:rgba(0,255,213,.05);border:1px solid rgba(0,255,213,.15);border-radius:20px;font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--accent);transition:all .3s}
#trust-badge.hidden{display:none}
#trust-badge.warn{background:rgba(248,113,113,.07);border-color:rgba(248,113,113,.2);color:#f87171}

/* STATS */
.stats-bar{display:flex;gap:8px;margin:12px 0}
.stat-box{flex:1;background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:10px;padding:10px 6px;text-align:center}
.stat-val{font-family:'IBM Plex Mono',monospace;font-size:20px;font-weight:700;color:var(--accent)}
.stat-lbl{font-size:9px;color:rgba(240,232,255,.7);text-transform:uppercase;letter-spacing:1px;margin-top:3px}
.stat-caption{font-family:'IBM Plex Mono',monospace;font-size:8px;color:rgba(240,232,255,.3);margin-top:2px}

/* RATE BAR */
.rate-bar{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:10px 14px;margin-bottom:6px;display:flex;align-items:center;justify-content:space-between;gap:10px}
.rate-left{font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--muted);white-space:nowrap}
.rate-left strong{color:var(--accent)}
.rate-dots{display:flex;gap:3px;flex-wrap:wrap;justify-content:flex-end}
.rate-dot{width:7px;height:7px;border-radius:50%;background:var(--purple2)}
.rate-dot.used{background:var(--border);opacity:.5}
.rate-exhausted{font-family:'IBM Plex Mono',monospace;font-size:11px;color:#f87171;text-align:center;padding:8px 14px;background:rgba(248,113,113,.08);border:1px solid rgba(248,113,113,.2);border-radius:8px;margin-bottom:8px;display:none}
.rate-exhausted.show{display:block}

/* CARD */
.card{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px;margin-bottom:10px}
.lang-row{display:flex;gap:6px;margin-bottom:12px}
.lang-btn{flex:1;padding:8px;background:transparent;border:1px solid var(--border);border-radius:8px;color:var(--muted);font-family:'IBM Plex Mono',monospace;font-size:12px;cursor:pointer;transition:all .2s}
.lang-btn.active{background:rgba(139,92,246,.2);border-color:var(--purple3);color:var(--purple3)}
.field-label{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:5px}
select{width:100%;padding:10px 12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--white);font-family:'Outfit',sans-serif;font-size:14px;margin-bottom:12px;outline:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%238b5cf6' d='M6 8L0 0h12z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center}
select:focus{border-color:var(--purple3)}
select option{background:#1a0032;color:var(--white)}
textarea{width:100%;height:108px;padding:12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--white);font-family:'IBM Plex Mono',monospace;font-size:12px;resize:none;outline:none;line-height:1.6;transition:border-color .2s}
textarea:focus{border-color:var(--purple3);box-shadow:0 0 0 2px rgba(139,92,246,.1)}
textarea::placeholder{color:var(--muted)}
.char-row{display:flex;justify-content:space-between;align-items:center;margin-top:5px;margin-bottom:12px}
.clear-btn{background:transparent;border:1px solid var(--border);color:var(--muted);padding:4px 10px;border-radius:6px;font-size:11px;font-family:'IBM Plex Mono',monospace;cursor:pointer;transition:all .2s}
.clear-btn:hover{border-color:var(--purple3);color:var(--purple3)}
.char-count{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted)}

/* ANALYZE BTN */
#analyze-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--purple2),#4c1d95);border:none;border-radius:10px;color:#fff;font-family:'Outfit',sans-serif;font-weight:700;font-size:15px;letter-spacing:.5px;cursor:pointer;transition:all .2s;box-shadow:0 4px 20px rgba(124,58,237,.4);position:relative;overflow:hidden}
#analyze-btn:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 8px 28px rgba(124,58,237,.5)}
#analyze-btn:disabled{opacity:.4;cursor:not-allowed;transform:none}
#analyze-btn.loading::after{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent);animation:shimmer 1s infinite}
@keyframes shimmer{to{left:100%}}
.trust-row{display:flex;justify-content:center;gap:12px;margin-top:8px;flex-wrap:wrap}
.trust-item{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--muted)}
.trust-item::before{content:'‚úì ';color:var(--accent)}

/* RESULT */
#result-card{display:none;background:var(--surface);border-radius:14px;overflow:hidden;margin-bottom:10px;border:1px solid var(--border);animation:slideIn .3s ease}
@keyframes slideIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.result-header{padding:16px;display:flex;align-items:center;gap:12px}
.verdict-icon{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;font-weight:900}
.verdict-label{font-size:19px;font-weight:900;line-height:1.2}
.verdict-sub{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);margin-top:3px}
.verdict-code{font-family:'IBM Plex Mono',monospace;font-size:9px;color:rgba(240,232,255,.3);margin-top:2px}

/* MANDATORY DISCLAIMER inside result */
.result-disclaimer{padding:10px 16px;background:rgba(248,113,113,.06);border-bottom:1px solid rgba(248,113,113,.15);font-family:'IBM Plex Mono',monospace;font-size:10px;color:#f87171;line-height:1.6}

/* SUMMARY */
.summary-line{padding:10px 16px 12px;font-size:13px;color:var(--white);line-height:1.5;border-bottom:1px solid var(--border)}

/* HASHCHAIN STRIP */
.hash-strip{margin:0 16px 12px;display:flex;align-items:center;gap:8px;padding:8px 12px;background:rgba(0,255,213,.06);border:1px solid rgba(0,255,213,.18);border-radius:8px}
.hash-strip-left{display:flex;align-items:center;gap:8px;flex:1;min-width:0}
.hash-strip-icon{font-size:14px;color:var(--accent);flex-shrink:0}
.hash-strip-texts{min-width:0}
.hash-strip-label{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--accent)}
.hash-strip-val{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--muted);margin-top:1px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.hash-copy-btn{flex-shrink:0;font-size:11px;color:var(--muted);padding:3px 8px;border:1px solid var(--border);border-radius:5px;background:transparent;cursor:pointer;font-family:'IBM Plex Mono',monospace;transition:all .2s}
.hash-copy-btn:hover{color:var(--accent);border-color:var(--accent)}
.hash-learn{flex-shrink:0;font-size:10px;color:var(--purple3);text-decoration:none;font-family:'IBM Plex Mono',monospace;padding:3px 8px;border:1px solid var(--border);border-radius:5px;transition:all .2s}
.hash-learn:hover{border-color:var(--purple3)}

/* CONFIDENCE */
.conf-wrap{padding:12px 16px}
.conf-top{display:flex;justify-content:space-between;font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);margin-bottom:5px}
.conf-bar{height:6px;background:rgba(255,255,255,.08);border-radius:3px;overflow:hidden}
.conf-fill{height:100%;border-radius:3px;width:0%;transition:width .8s cubic-bezier(.4,0,.2,1)}
.conf-label{font-family:'IBM Plex Mono',monospace;font-size:9px;margin-top:5px}
.conf-note{font-size:9px;color:var(--muted);margin-top:3px}

/* RULES + TRACE */
.section-wrap{padding:0 16px 12px}
.collapsible-btn{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--purple3);cursor:pointer;background:none;border:none;padding:0;display:flex;align-items:center;gap:6px;margin-bottom:6px}
.arrow{display:inline-block;transition:transform .2s;font-style:normal;font-size:8px}
.arrow.open{transform:rotate(90deg)}
.collapsible-body{display:none;flex-wrap:wrap;gap:5px}
.collapsible-body.open{display:flex}
.trace-inner{display:none}
.trace-inner.open{display:block}
.rule-tag{padding:4px 10px;border-radius:20px;font-family:'IBM Plex Mono',monospace;font-size:10px;border:1px solid;display:inline-block}
.trace-row{display:flex;justify-content:space-between;font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);padding:4px 0;border-bottom:1px solid rgba(255,255,255,.04)}
.trace-val{color:var(--purple3)}
.trace-note{font-family:'IBM Plex Mono',monospace;font-size:9px;color:rgba(240,232,255,.3);margin-bottom:6px}

/* SHARE + COPY */
.actions-wrap{padding:12px 16px;border-top:1px solid var(--border)}
.actions-btns{display:flex;gap:8px}
.action-btn{flex:1;padding:10px;border-radius:8px;font-family:'IBM Plex Mono',monospace;font-size:12px;cursor:pointer;transition:all .2s;font-weight:600}
.btn-share{background:var(--purple2);border:none;color:#fff}
.btn-share:hover{opacity:.85}
.btn-copy{background:transparent;border:1px solid var(--border);color:var(--muted)}
.btn-copy:hover{border-color:var(--accent);color:var(--accent)}
.actions-note{font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--muted);margin-top:6px;text-align:center}

/* SAFE NOTICE */
.safe-notice{padding:10px 16px;background:rgba(139,92,246,.05);border-top:1px solid var(--border);font-size:11px;color:var(--muted);line-height:1.6}

/* FEEDBACK */
.feedback-wrap{padding:10px 16px;border-top:1px solid var(--border);display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.feedback-lbl{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted)}
.fb-btn{padding:5px 12px;background:transparent;border:1px solid var(--border);border-radius:20px;font-size:11px;color:var(--muted);cursor:pointer;font-family:'IBM Plex Mono',monospace;transition:all .3s}
.fb-btn.selected{background:rgba(139,92,246,.15);border-color:var(--purple3);color:var(--purple3);opacity:.7}
.fb-btn:disabled{opacity:.4;cursor:not-allowed}
.fb-thanks{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--accent);display:none;width:100%;margin-top:4px}
.fb-thanks.show{display:block}
.fb-once{font-family:'IBM Plex Mono',monospace;font-size:9px;color:rgba(240,232,255,.3);width:100%;margin-top:2px}

/* EXAMPLES */
.examples-section{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:10px}
.section-title{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.section-sub{font-family:'IBM Plex Mono',monospace;font-size:9px;color:rgba(240,232,255,.3);margin-bottom:10px}
.example-btns{display:flex;flex-direction:column;gap:6px}
.ex-btn{width:100%;padding:9px 12px;background:transparent;border:1px solid var(--border);border-radius:8px;color:var(--muted);font-family:'IBM Plex Mono',monospace;font-size:11px;cursor:pointer;text-align:left;transition:all .2s}
.ex-btn:hover{border-color:var(--purple3);color:var(--purple3);background:rgba(139,92,246,.05)}

/* DISCLAIMER */
.disclaimer-always{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:10px}
.disclaimer-always strong{display:block;font-family:'IBM Plex Mono',monospace;font-size:10px;color:#f87171;letter-spacing:1px;margin-bottom:6px}
.disclaimer-always p{font-size:12px;color:rgba(240,232,255,.75);line-height:1.7}

/* TRANSPARENCY */
.transparency{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:10px}
.trans-list{display:flex;flex-direction:column;gap:7px;margin-top:10px}
.trans-item{font-size:12px;color:var(--white);display:flex;align-items:center;gap:8px}
.trans-item::before{content:'‚óÜ';color:var(--purple3);font-size:8px;flex-shrink:0}

/* TRUST FOOTER */
.trust-footer{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:14px 16px;margin-bottom:10px;text-align:center}
.tf-row1{font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--white);margin-bottom:4px}
.tf-row1 span{color:var(--accent)}
.tf-row2{font-size:11px;color:var(--muted)}

footer{text-align:center;font-family:'IBM Plex Mono',monospace;font-size:9px;color:var(--muted);padding:16px 0 8px;line-height:1.9}
footer span{color:var(--purple3)}

/* TOAST */
#toast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%);background:var(--surface2);border:1px solid var(--accent);border-radius:8px;padding:8px 18px;font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--accent);z-index:300;opacity:0;transition:opacity .3s;pointer-events:none;white-space:nowrap}
#toast.show{opacity:1}

/* MODALS */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:200;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(6px)}
.modal-overlay.show{display:flex}
.modal-box{background:var(--surface2);border:1px solid var(--border2);border-radius:16px;padding:28px;max-width:340px;width:100%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.6),var(--glow)}
.modal-icon{font-size:38px;margin-bottom:10px}
.modal-title{font-size:17px;font-weight:700;color:var(--purple3);margin-bottom:8px}
.modal-text{font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--muted);line-height:1.8;margin-bottom:16px}
.modal-close{padding:10px 24px;background:var(--purple2);border:none;border-radius:8px;color:#fff;font-family:'Outfit',sans-serif;font-weight:600;font-size:13px;cursor:pointer}

/* VERDICT COLORS ‚Äî v0=UNKNOWN,v1=LOW,v2=SUSPICIOUS,v3=HIGH */
.v0{color:var(--v0)}.v1{color:var(--v1)}.v2{color:var(--v2)}.v3{color:var(--v3)}
.bg0{background:rgba(99,102,241,.12)}.bg1{background:rgba(34,197,94,.10)}.bg2{background:rgba(251,146,60,.12)}.bg3{background:rgba(248,113,113,.12)}
.fill0{background:var(--v0)}.fill1{background:var(--v1)}.fill2{background:var(--v2)}.fill3{background:var(--v3)}
.rt0{color:var(--v0);border-color:rgba(99,102,241,.3);background:rgba(99,102,241,.08)}
.rt1{color:var(--v1);border-color:rgba(34,197,94,.3);background:rgba(34,197,94,.08)}
.rt2{color:var(--v2);border-color:rgba(251,146,60,.3);background:rgba(251,146,60,.08)}
.rt3{color:var(--v3);border-color:rgba(248,113,113,.3);background:rgba(248,113,113,.08)}
.cl0{color:rgba(99,102,241,.8)}.cl1{color:rgba(34,197,94,.8)}.cl2{color:rgba(251,146,60,.8)}.cl3{color:rgba(248,113,113,.8)}
</style>
</head>
<body>

<div id="warn-bar">
  <span id="warn-text">‚ö† This tool analyzes text for known risk patterns only. It does NOT confirm fraud. Low risk does NOT mean safe. Final responsibility remains with the user.</span>
</div>

<div id="app">

  <!-- HEADER -->
  <div class="header">
    <div class="logo-wrap">
      <div class="logo-icon">üõ°Ô∏è</div>
      <div class="logo-name">Veritas Guard</div>
    </div>
    <div class="tagline" id="tagline-text">DETERMINISTIC RISK SIGNALS ¬∑ NO GUESSING</div>

    <!-- ENGINE BADGE ‚Äî dynamic from /health -->
    <div class="engine-badge" id="engine-badge" onclick="document.getElementById('info-popup').classList.add('show')">
      <div class="dot"></div>
      <span id="engine-ver-text">ENGINE ‚Äî CHECKING...</span>
    </div>

    <!-- TRUST BADGE ‚Äî disappears if not verified -->
    <div id="trust-badge">üîí Rules Hard-Locked ¬∑ <span id="trust-ver">...</span></div>
  </div>

  <!-- STATS -->
  <div class="stats-bar">
    <div class="stat-box">
      <div class="stat-val" id="stat-total">0</div>
      <div class="stat-lbl" id="lbl-total">Total Scans</div>
      <div class="stat-caption">Session-based</div>
    </div>
    <div class="stat-box">
      <div class="stat-val" id="stat-today">0</div>
      <div class="stat-lbl" id="lbl-today">Today</div>
      <div class="stat-caption">Resets midnight</div>
    </div>
    <div class="stat-box">
      <div class="stat-val" id="stat-flagged">0</div>
      <div class="stat-lbl">Flagged</div>
      <div class="stat-caption">Risk found</div>
    </div>
  </div>

  <!-- RATE BAR -->
  <div class="rate-bar">
    <div class="rate-left" id="rate-text">Remaining: <strong>10</strong>/10</div>
    <div class="rate-dots" id="rate-dots"></div>
  </div>
  <div class="rate-exhausted" id="rate-exhausted">Daily limit reached. Try again later.</div>

  <!-- INPUT CARD -->
  <div class="card">
    <div class="lang-row">
      <button class="lang-btn active" id="btn-en" onclick="setLang('en')">EN</button>
      <button class="lang-btn" id="btn-hi" onclick="setLang('hi')">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    </div>
    <div class="field-label" id="lbl-usecase">USE CASE</div>
    <select id="usecase">
      <option value="cyber"      data-en="Cyber / Fraud"        data-hi="‡§∏‡§æ‡§á‡§¨‡§∞ / ‡§´‡•ç‡§∞‡•â‡§°">Cyber / Fraud</option>
      <option value="banking"    data-en="Banking / Fintech"     data-hi="‡§¨‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó / ‡§´‡§ø‡§®‡§ü‡•á‡§ï">Banking / Fintech</option>
      <option value="legal"      data-en="Legal / Compliance"    data-hi="‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä / ‡§Ö‡§®‡•Å‡§™‡§æ‡§≤‡§®">Legal / Compliance</option>
      <option value="health"     data-en="Healthcare"            data-hi="‡§π‡•á‡§≤‡•ç‡§•‡§ï‡•á‡§Ø‡§∞">Healthcare</option>
      <option value="insurance"  data-en="Insurance"             data-hi="‡§¨‡•Ä‡§Æ‡§æ">Insurance</option>
      <option value="govt"       data-en="Government / Public"   data-hi="‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä / ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï">Government / Public</option>
      <option value="ecom"       data-en="E-commerce"            data-hi="‡§à-‡§ï‡•â‡§Æ‡§∞‡•ç‡§∏">E-commerce</option>
      <option value="edu"        data-en="Education / Research"  data-hi="‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ / ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§®">Education / Research</option>
      <option value="enterprise" data-en="Enterprise Security"   data-hi="‡§è‡§Ç‡§ü‡§∞‡§™‡•ç‡§∞‡§æ‡§á‡§ú ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ">Enterprise Security</option>
    </select>
    <div class="field-label" id="lbl-input">MESSAGE / SMS / LINK</div>
    <textarea id="input-text" placeholder="Paste SMS, WhatsApp message, or link here..." maxlength="1000"></textarea>
    <div class="char-row">
      <button class="clear-btn" id="clear-btn">‚úï CLEAR</button>
      <span class="char-count"><span id="char-val">0</span> / 1000</span>
    </div>
    <button id="analyze-btn" onclick="doAnalyze()">
      <span id="btn-text">‚ö° ANALYZE RISK SIGNALS</span>
    </button>
    <div class="trust-row">
      <span class="trust-item" id="nd1">No Login</span>
      <span class="trust-item" id="nd2">No Storage</span>
      <span class="trust-item" id="nd3">Deterministic Rules</span>
    </div>
  </div>

  <!-- RESULT CARD -->
  <div id="result-card"></div>

  <!-- EXAMPLES -->
  <div class="examples-section">
    <div class="section-title" id="ex-title">TRY AN EXAMPLE</div>
    <div class="section-sub" id="ex-sub">Examples are simulated messages</div>
    <div class="example-btns">
      <button class="ex-btn" id="ex1" onclick="loadExample(0)">üö® Try scam example</button>
      <button class="ex-btn" id="ex2" onclick="loadExample(1)">üè¶ Try bank SMS example</button>
      <button class="ex-btn" id="ex3" onclick="loadExample(2)">üèõÔ∏è Try government advisory example</button>
    </div>
  </div>

  <!-- DISCLAIMER ‚Äî fixed legal wording -->
  <div class="disclaimer-always">
    <strong id="disc-title">‚ö† DISCLAIMER</strong>
    <p id="disc-body">This tool analyzes messages for known risk patterns only. It does not confirm fraud. Low risk does NOT mean safe. Final responsibility remains with the user.</p>
  </div>

  <!-- HOW IT WORKS -->
  <div class="transparency">
    <div class="section-title" id="trans-title">HOW THIS WORKS</div>
    <div class="trans-list">
      <div class="trans-item" id="tr1">No login required</div>
      <div class="trans-item" id="tr2">No message content stored</div>
      <div class="trans-item" id="tr3">Deterministic rules ‚Äî no guessing, no prediction</div>
      <div class="trans-item" id="tr4">Hash-sealed engine ‚Äî rules cannot change without re-seal</div>
    </div>
  </div>

  <!-- TRUST FOOTER -->
  <div class="trust-footer">
    <div class="tf-row1">ENGINE <span id="footer-ver">v1.2</span> ¬∑ STATUS: <span>RULES FROZEN</span></div>
    <div class="tf-row2">Deterministic engine ¬∑ No guessing ¬∑ No message storage</div>
  </div>

  <footer>¬© <span>Veritas Engine</span> ‚Äî Open Risk Awareness Tool</footer>
</div>

<!-- TOAST -->
<div id="toast"></div>

<!-- LIMIT MODAL -->
<div class="modal-overlay" id="limit-modal">
  <div class="modal-box">
    <div class="modal-icon">‚è≥</div>
    <div class="modal-title" id="modal-title">Daily Limit Reached</div>
    <div class="modal-text" id="modal-text">You have used all 10 analyses for today.<br>Please try again after 24 hours.</div>
    <button class="modal-close" onclick="document.getElementById('limit-modal').classList.remove('show')">UNDERSTOOD</button>
  </div>
</div>

<!-- INFO POPUP -->
<div class="modal-overlay" id="info-popup">
  <div class="modal-box">
    <div class="modal-icon">üõ°Ô∏è</div>
    <div class="modal-title">About Veritas Guard</div>
    <div class="modal-text" id="info-text">Veritas Guard analyzes text for known risk patterns using deterministic rules.<br><br>It does NOT block, verify, report, or guarantee anything.<br><br>Low risk does NOT mean safe.<br><br>Powered by deterministic pattern rules ‚Äî not AI.</div>
    <button class="modal-close" onclick="document.getElementById('info-popup').classList.remove('show')">UNDERSTOOD</button>
  </div>
</div>

<!-- HASHCHAIN POPUP -->
<div class="modal-overlay" id="hash-popup">
  <div class="modal-box">
    <div class="modal-icon">üîí</div>
    <div class="modal-title">Hashchain Verified</div>
    <div class="modal-text">Result is hash-sealed. Engine rules cannot change without re-seal.<br><br>This ensures the engine that ran is exactly the version shown.<br><br>You can share this result as cryptographic proof.</div>
    <button class="modal-close" onclick="document.getElementById('hash-popup').classList.remove('show')">UNDERSTOOD</button>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CONFIG
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const ENGINE_BASE  = "https://api.veritasengine.in";
const ENGINE_URL   = ENGINE_BASE + "/decide";
const HEALTH_URL   = ENGINE_BASE + "/health";
const STATS_URL    = ENGINE_BASE + "/stats";
const DAILY_LIMIT  = 10;
const DEV_CODE     = "VERITAS-DEV-2026";

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   V1.2 DECISION MAPPING (EXACT)
   0=UNKNOWN 1=LOW_RISK 2=SUSPICIOUS 3=HIGH_RISK
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/*
  ENGINE v1.2 DECISION BEHAVIOR:
  0 = NORMAL    ‚Üí conf  0‚Äì20%  ‚Üí very weak / no signals
  1 = ATTENTION ‚Üí conf 20‚Äì45%  ‚Üí partial / early signals
  2 = SUSPECT   ‚Üí conf 45‚Äì75%  ‚Üí multiple known patterns
  3 = HIGH_RISK ‚Üí conf 75‚Äì100% ‚Üí strong + confirmed fraud
*/
const DECISION_MAP = {
  en: {
    label:   [
      "No Pattern Detected",          // 0 ‚Äì NORMAL
      "Attention Required",           // 1 ‚Äì ATTENTION
      "Suspicious Patterns Found",    // 2 ‚Äì SUSPECT
      "High Risk ‚Äì Likely Scam"       // 3 ‚Äì HIGH_RISK
    ],
    sub: [
      "No known risk signals in this message",         // 0
      "Weak or partial risk signals detected",         // 1
      "Multiple known suspicious patterns detected",   // 2
      "Strong, confirmed fraud pattern signals"        // 3
    ],
    code: [
      "DECISION: 0 ¬∑ NORMAL",
      "DECISION: 1 ¬∑ ATTENTION",
      "DECISION: 2 ¬∑ SUSPECT",
      "DECISION: 3 ¬∑ HIGH_RISK"
    ],
    confRange: [
      "Signal strength: 0‚Äì20%",   // 0
      "Signal strength: 20‚Äì45%",  // 1
      "Signal strength: 45‚Äì75%",  // 2
      "Signal strength: 75‚Äì100%"  // 3
    ],
    summary: [
      "No known risk patterns were found in this message. This does NOT mean the message is safe.",
      "Weak risk indicators detected. Verify the sender before taking any action.",
      "Multiple risk patterns detected. Do not click links or share any details.",
      "Strong scam indicators detected. Do not proceed, share details, or make payments."
    ],
    // conf label based on raw % ‚Äî shown below bar
    confBands: [
      { max: 20,  label: "Very low signal ‚Äî no strong patterns matched",    cls: "cl0" },
      { max: 45,  label: "Weak signal ‚Äî partial or early patterns matched", cls: "cl1" },
      { max: 75,  label: "Moderate signal ‚Äî multiple patterns matched",     cls: "cl2" },
      { max: 101, label: "Strong signal ‚Äî confirmed high-risk patterns",    cls: "cl3" }
    ],
    confNote: "Confidence reflects pattern match strength only. It does NOT confirm fraud or guarantee safety.",
    emoji:    ["‚Äî","!","‚ö†","‚úñ"],
    rulesLabel: "TRIGGERED RULES",
    traceLabel: "TRACE",
    traceNote:  "Technical details for auditors",
    hashVerified: "Hashchain Verified",
    hashCopy: "Copy Hash",
    hashLearn: "Learn more",
    hashCopied: "Verification hash copied",
    safeNotice: "Genuine messages can sometimes match risk patterns. This engine does not guarantee legitimacy.",
    disclaimer: "This engine does not guarantee safety or fraud. Results are pattern-based only.",
    fbLabel: "Was this helpful?", fbYes: "Helpful", fbNo: "Not Helpful",
    fbThanks: "Thanks. Feedback recorded (anonymous).",
    fbOnce: "One feedback per result.",
    shareBtn: "SHARE", copyBtn: "COPY PROOF",
    actionsNote: "Shares verdict, confidence % & proof hash",
    toastCopied: "Proof copied ‚úì",
    noRules: "No specific patterns triggered"
  },
  hi: {
    label:   [
      "‡§ï‡•ã‡§à ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ",         // 0 ‚Äì NORMAL
      "‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç",                    // 1 ‚Äì ATTENTION
      "‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡•á",          // 2 ‚Äì SUSPECT
      "‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‚Äì ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∏‡•ç‡§ï‡•à‡§Æ"   // 3 ‚Äì HIGH_RISK
    ],
    sub: [
      "‡§á‡§∏ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§®‡§π‡•Ä‡§Ç",      // 0
      "‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§Ø‡§æ ‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á",              // 1
      "‡§ï‡§à ‡§ú‡•ç‡§û‡§æ‡§§ ‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡•á",                  // 2
      "‡§Æ‡§ú‡§¨‡•Ç‡§§, ‡§™‡•Å‡§∑‡•ç‡§ü ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§∏‡§Ç‡§ï‡•á‡§§"            // 3
    ],
    code: [
      "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø: 0 ¬∑ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø",
      "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø: 1 ¬∑ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç",
      "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø: 2 ¬∑ ‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß",
      "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø: 3 ¬∑ ‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ"
    ],
    confRange: [
      "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§∂‡§ï‡•ç‡§§‡§ø: 0‚Äì20%",
      "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§∂‡§ï‡•ç‡§§‡§ø: 20‚Äì45%",
      "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§∂‡§ï‡•ç‡§§‡§ø: 45‚Äì75%",
      "‡§∏‡§Ç‡§ï‡•á‡§§ ‡§∂‡§ï‡•ç‡§§‡§ø: 75‚Äì100%"
    ],
    summary: [
      "‡§á‡§∏ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§á‡§∏‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§Ø‡§π ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§",
      "‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á‡•§ ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§™‡•ç‡§∞‡•á‡§∑‡§ï ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç‡•§",
      "‡§ï‡§à ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡•á‡•§ ‡§ï‡•ã‡§à ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§ï‡•ã‡§à ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§æ‡§ù‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§",
      "‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§∏‡•ç‡§ï‡•à‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á‡•§ ‡§Ü‡§ó‡•á ‡§® ‡§¨‡§¢‡§º‡•á‡§Ç, ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§æ‡§ù‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§ï‡•ã‡§à ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§"
    ],
    confBands: [
      { max: 20,  label: "‡§¨‡§π‡•Å‡§§ ‡§ï‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‚Äî ‡§ï‡•ã‡§à ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ",   cls: "cl0" },
      { max: 45,  label: "‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§∏‡§Ç‡§ï‡•á‡§§ ‚Äî ‡§Ü‡§Ç‡§∂‡§ø‡§ï ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡•á",              cls: "cl1" },
      { max: 75,  label: "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‚Äî ‡§ï‡§à ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡•á",                 cls: "cl2" },
      { max: 101, label: "‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§∏‡§Ç‡§ï‡•á‡§§ ‚Äî ‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø",   cls: "cl3" }
    ],
    confNote: "‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§ï‡•á‡§µ‡§≤ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§Æ‡§ø‡§≤‡§æ‡§® ‡§ï‡•Ä ‡§§‡§æ‡§ï‡§§ ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§",
    emoji:    ["‚Äî","!","‚ö†","‚úñ"],
    rulesLabel: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ø‡§Ø‡§Æ",
    traceLabel: "‡§ü‡•ç‡§∞‡•á‡§∏",
    traceNote:  "‡§ë‡§°‡§ø‡§ü‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£",
    hashVerified: "‡§π‡•à‡§∂‡§ö‡•á‡§® ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§",
    hashCopy: "‡§π‡•à‡§∂ ‡§ï‡•â‡§™‡•Ä",
    hashLearn: "‡§î‡§∞ ‡§ú‡§æ‡§®‡•á‡§Ç",
    hashCopied: "‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§π‡•à‡§∂ ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ",
    safeNotice: "‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•Ä ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§∏‡•á ‡§Æ‡•á‡§≤ ‡§ñ‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π ‡§á‡§Ç‡§ú‡§® ‡§µ‡•à‡§ß‡§§‡§æ ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á‡§§‡§æ‡•§",
    disclaimer: "‡§Ø‡§π ‡§á‡§Ç‡§ú‡§® ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§Ø‡§æ ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á‡§§‡§æ‡•§ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ï‡•á‡§µ‡§≤ ‡§™‡•à‡§ü‡§∞‡•ç‡§®-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§π‡•à‡§Ç‡•§",
    fbLabel: "‡§ï‡•ç‡§Ø‡§æ ‡§Ø‡§π ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§•‡§æ?", fbYes: "‡§∏‡§π‡§æ‡§Ø‡§ï", fbNo: "‡§∏‡§π‡§æ‡§Ø‡§ï ‡§®‡§π‡•Ä‡§Ç",
    fbThanks: "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶‡•§ ‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§¶‡§∞‡•ç‡§ú (‡§ó‡•Å‡§Æ‡§®‡§æ‡§Æ)‡•§",
    fbOnce: "‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§è‡§ï ‡§´‡•Ä‡§°‡§¨‡•à‡§ï‡•§",
    shareBtn: "‡§∂‡•á‡§Ø‡§∞", copyBtn: "‡§™‡•ç‡§∞‡•Ç‡§´ ‡§ï‡•â‡§™‡•Ä",
    actionsNote: "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø, ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ % ‡§î‡§∞ ‡§™‡•ç‡§∞‡•Ç‡§´ ‡§π‡•à‡§∂ ‡§∂‡•á‡§Ø‡§∞ ‡§π‡•ã‡§ó‡§æ",
    toastCopied: "‡§™‡•ç‡§∞‡•Ç‡§´ ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ ‚úì",
    noRules: "‡§ï‡•ã‡§à ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ"
  }
};

const T = {
  en: {
    tagline:"DETERMINISTIC RISK SIGNALS ¬∑ NO GUESSING",
    lblUsecase:"USE CASE", lblInput:"MESSAGE / SMS / LINK",
    placeholder:"Paste SMS, WhatsApp message, or link here...",
    btnText:"‚ö° ANALYZE RISK SIGNALS", analyzing:"ANALYZING...",
    nd1:"No Login", nd2:"No Storage", nd3:"Deterministic Rules",
    lblTotal:"Total Scans", lblToday:"Today",
    rateText:"Remaining:", rateExhausted:"Daily limit reached. Try again later.",
    discTitle:"‚ö† DISCLAIMER",
    discBody:"This tool analyzes messages for known risk patterns only. It does not confirm fraud. Low risk does NOT mean safe. Final responsibility remains with the user.",
    transTitle:"HOW THIS WORKS",
    tr1:"No login required", tr2:"No message content stored",
    tr3:"Deterministic rules ‚Äî no guessing, no prediction",
    tr4:"Hash-sealed engine ‚Äî rules cannot change without re-seal",
    exTitle:"TRY AN EXAMPLE", exSub:"Examples are simulated messages",
    ex1:"üö® Try scam example", ex2:"üè¶ Try bank SMS example", ex3:"üèõÔ∏è Try government advisory example",
    modalTitle:"Daily Limit Reached",
    modalText:"You have used all 10 analyses for today.<br>Please try again after 24 hours."
  },
  hi: {
    tagline:"‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ¬∑ ‡§ï‡•ã‡§à ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç",
    lblUsecase:"‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞", lblInput:"‡§∏‡§Ç‡§¶‡•á‡§∂ / SMS / ‡§≤‡§ø‡§Ç‡§ï",
    placeholder:"SMS, WhatsApp ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§Ø‡§π‡§æ‡§Å ‡§ö‡§ø‡§™‡§ï‡§æ‡§è‡§Å...",
    btnText:"‚ö° ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç", analyzing:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
    nd1:"‡§ï‡•ã‡§à ‡§≤‡•â‡§ó‡§ø‡§® ‡§®‡§π‡•Ä‡§Ç", nd2:"‡§ï‡•ã‡§à ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§®‡§π‡•Ä‡§Ç", nd3:"‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡§ø‡§Ø‡§Æ",
    lblTotal:"‡§ï‡•Å‡§≤ ‡§ú‡§æ‡§Å‡§ö‡•á‡§Ç", lblToday:"‡§Ü‡§ú",
    rateText:"‡§∂‡•á‡§∑:", rateExhausted:"‡§¶‡•à‡§®‡§ø‡§ï ‡§∏‡•Ä‡§Æ‡§æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡•§ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§",
    discTitle:"‚ö† ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§∞‡§£",
    discBody:"‡§Ø‡§π ‡§ü‡•Ç‡§≤ ‡§ï‡•á‡§µ‡§≤ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§ ‡§ï‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§π‡•à‡•§",
    transTitle:"‡§Ø‡§π ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à",
    tr1:"‡§ï‡•ã‡§à ‡§≤‡•â‡§ó‡§ø‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§®‡§π‡•Ä‡§Ç", tr2:"‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§®‡§π‡•Ä‡§Ç",
    tr3:"‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡§ø‡§Ø‡§Æ ‚Äî ‡§ï‡•ã‡§à ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç",
    tr4:"‡§π‡•à‡§∂-‡§∏‡•Ä‡§≤‡•ç‡§° ‡§á‡§Ç‡§ú‡§® ‚Äî ‡§∞‡•Ä-‡§∏‡•Ä‡§≤ ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ ‡§®‡§ø‡§Ø‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á",
    exTitle:"‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Ü‡§ú‡§º‡§Æ‡§æ‡§è‡§Ç", exSub:"‡§Ø‡•á ‡§®‡§ï‡§≤‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§π‡•à‡§Ç ‚Äî ‡§ï‡•á‡§µ‡§≤ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è",
    ex1:"üö® ‡§∏‡•ç‡§ï‡•à‡§Æ ‡§â‡§¶‡§æ‡§π‡§∞‡§£", ex2:"üè¶ ‡§¨‡•à‡§Ç‡§ï SMS ‡§â‡§¶‡§æ‡§π‡§∞‡§£", ex3:"üèõÔ∏è ‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§â‡§¶‡§æ‡§π‡§∞‡§£",
    modalTitle:"‡§¶‡•à‡§®‡§ø‡§ï ‡§∏‡•Ä‡§Æ‡§æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§",
    modalText:"‡§Ü‡§™‡§®‡•á ‡§Ü‡§ú ‡§ï‡•Ä 10 ‡§ú‡§æ‡§Å‡§ö ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡§∞ ‡§≤‡•Ä ‡§π‡•à‡§Ç‡•§<br>24 ‡§ò‡§Ç‡§ü‡•á ‡§¨‡§æ‡§¶ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§"
  }
};

const EXAMPLES = [
  "Congratulations! You won Rs.5,00,000 lottery. Pay Rs.2,500 processing fee to claim your prize. Visit: bit.ly/claim-now",
  "Sent Rs.1,250 from HDFC Bank A/c XX1234 to Amazon Pay. UPI Ref 9837264512",
  "Important advisory from Ministry of Finance: Be aware of fake calls posing as income tax officials. Visit incometax.gov.in for official information."
];

let lang = localStorage.getItem('vg_lang') || 'en';
let lastResult = null;
let lastHash = '';
let engineVerified = false;
let engineVersion = '';

/* ‚ïê‚ïê HEALTH CHECK ‚Äî fetch version dynamically ‚ïê‚ïê */
async function checkHealth() {
  const badge = document.getElementById('engine-badge');
  const trustBadge = document.getElementById('trust-badge');
  const trustVer = document.getElementById('trust-ver');
  const footerVer = document.getElementById('footer-ver');
  const engVerText = document.getElementById('engine-ver-text');
  const infoText = document.getElementById('info-text');

  try {
    const res = await fetch(HEALTH_URL, { signal: AbortSignal.timeout(5000) });
    if (!res.ok) throw new Error('health fail');
    const d = await res.json();

    const ver = d.version || d.engine_version || 'unknown';
    const frozen = d.rules_frozen !== false;
    const hashOk = d.hashchain_verified !== false;

    engineVersion = ver;
    engineVerified = frozen && hashOk;

    engVerText.textContent = 'ENGINE ' + ver + ' ‚Äî ONLINE';
    trustVer.textContent = ver;
    footerVer.textContent = ver;

    if (engineVerified) {
      badge.classList.remove('unverified');
      trustBadge.classList.remove('hidden','warn');
    } else {
      badge.classList.add('unverified');
      trustBadge.classList.add('warn');
      trustBadge.textContent = '‚ö† Engine verification failed';
    }

    if (infoText) {
      infoText.innerHTML =
        'Engine version: <strong>' + ver + '</strong><br>' +
        'Rules frozen: ' + (frozen ? '‚úî Yes' : '‚úñ No') + '<br>' +
        'Hashchain: ' + (hashOk ? '‚úî Verified' : '‚úñ Not verified') + '<br><br>' +
        'This tool does NOT confirm fraud.<br>Low risk does NOT mean safe.';
    }
  } catch(e) {
    engVerText.textContent = 'ENGINE ‚Äî UNREACHABLE';
    badge.classList.add('unverified');
    trustBadge.classList.add('warn');
    trustBadge.textContent = '‚ö† Engine unreachable';
  }
}

/* ‚ïê‚ïê RATE LIMIT ‚ïê‚ïê */
function getRateData() {
  const today = new Date().toDateString();
  try {
    const d = JSON.parse(localStorage.getItem('vg_rate') || '{}');
    return d.date === today ? d : { date: today, used: 0 };
  } catch(e) { return { date: new Date().toDateString(), used: 0 }; }
}
function saveRateData(d) { localStorage.setItem('vg_rate', JSON.stringify(d)); }
function getRem() { return Math.max(0, DAILY_LIMIT - getRateData().used); }
function incUse() { const d = getRateData(); d.used++; saveRateData(d); }

function renderRateBar() {
  const rem = getRem();
  const t = T[lang];
  document.getElementById('rate-text').innerHTML = t.rateText + ' <strong>' + rem + '</strong>/' + DAILY_LIMIT;
  const el = document.getElementById('rate-dots');
  el.innerHTML = '';
  for (let i = 0; i < DAILY_LIMIT; i++) {
    const d = document.createElement('div');
    d.className = 'rate-dot' + (i >= rem ? ' used' : '');
    el.appendChild(d);
  }
  const btn = document.getElementById('analyze-btn');
  const exMsg = document.getElementById('rate-exhausted');
  if (rem <= 0) {
    btn.disabled = true;
    exMsg.textContent = t.rateExhausted;
    exMsg.classList.add('show');
  } else {
    btn.disabled = false;
    exMsg.classList.remove('show');
  }
}

/* ‚ïê‚ïê STATS ‚ïê‚ïê */
async function loadStats() {
  try {
    const res = await fetch(STATS_URL, { signal: AbortSignal.timeout(4000) });
    if (!res.ok) return;
    const d = await res.json();
    if (d.total   !== undefined) document.getElementById('stat-total').textContent   = d.total;
    if (d.today   !== undefined) document.getElementById('stat-today').textContent   = d.today;
    if (d.flagged !== undefined) document.getElementById('stat-flagged').textContent = d.flagged;
  } catch(e) {}
}

/* ‚ïê‚ïê ENGINE CALL ‚ïê‚ïê */
async function callEngine(text) {
  try {
    const res = await fetch(ENGINE_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ input: text })
    });
    if (!res.ok) throw new Error('engine error');
    const data = await res.json();
    return {
      verdict:     data.decision,
      confidence:  data.confidence  || 0,
      fired_rules: data.fired_rules || [],
      trace:       data.trace       || [],
      intent:      data.intent      || '',
      hash:        data.hash        || 'pending'
    };
  } catch(e) { return null; }
}

/* ‚ïê‚ïê ANALYZE ‚ïê‚ïê */
async function doAnalyze() {
  const text = document.getElementById('input-text').value.trim();
  if (!text) {
    document.getElementById('input-text').style.borderColor = '#f87171';
    setTimeout(() => document.getElementById('input-text').style.borderColor = '', 1000);
    return;
  }
  if (getRem() <= 0) {
    document.getElementById('limit-modal').classList.add('show');
    return;
  }
  const t = T[lang];
  const dm = DECISION_MAP[lang];
  const btn = document.getElementById('analyze-btn');
  btn.disabled = true;
  btn.classList.add('loading');
  document.getElementById('btn-text').textContent = t.analyzing;

  const r = await callEngine(text);

  btn.disabled = false;
  btn.classList.remove('loading');
  document.getElementById('btn-text').textContent = t.btnText;

  if (!r || r.verdict === undefined) {
    alert('‚ùå Engine not reachable ‚Äî check server');
    renderRateBar();
    return;
  }

  incUse();
  renderRateBar();
  lastResult = r;
  lastHash = r.hash || '';
  loadStats();
  showResult(r, dm);
}

/* ‚ïê‚ïê CONF LABEL ‚Äî engine behavior bands ‚ïê‚ïê
   0=NORMAL 0-20% | 1=ATTENTION 20-45% | 2=SUSPECT 45-75% | 3=HIGH_RISK 75-100%
*/
function confLabel(conf, dm) {
  for (const band of dm.confBands) {
    if (conf < band.max) return { label: band.label, cls: band.cls };
  }
  return { label: dm.confBands[3].label, cls: dm.confBands[3].cls };
}

/* ‚ïê‚ïê TRUNCATE HASH ‚ïê‚ïê */
function trunc(h) {
  if (!h || h.length < 14) return h;
  return h.slice(0,6) + '¬∑¬∑¬∑' + h.slice(-6);
}

/* ‚ïê‚ïê SHOW RESULT ‚ïê‚ïê */
function showResult(r, dm) {
  const v    = r.verdict;
  const conf = r.confidence || 0;

  const rulesHTML = r.fired_rules && r.fired_rules.length > 0
    ? r.fired_rules.map(rule => '<span class="rule-tag rt' + v + '">' + rule + '</span>').join('')
    : '<span class="rule-tag" style="color:var(--muted);border-color:var(--border)">' + dm.noRules + '</span>';

  const traceHTML = (r.trace || []).map(step =>
    '<div class="trace-row"><span>' + (step.step || '‚Äî') + '</span><span class="trace-val">' +
    (step.score !== undefined ? step.score : (step.weight !== undefined ? '+' + step.weight : '‚Äî')) +
    '</span></div>'
  ).join('') || '<div class="trace-row"><span>‚Äî</span><span class="trace-val">‚Äî</span></div>';

  const verStr = engineVersion ? ' ¬∑ ' + engineVersion : '';

  const el = document.getElementById('result-card');
  el.innerHTML =
    /* VERDICT HEADER */
    '<div class="result-header bg' + v + '">' +
      '<div class="verdict-icon bg' + v + ' v' + v + '">' + dm.emoji[v] + '</div>' +
      '<div>' +
        '<div class="verdict-label v' + v + '">' + dm.label[v] + '</div>' +
        '<div class="verdict-sub">' + dm.sub[v] + '</div>' +
        '<div class="verdict-code">' + dm.code[v] + ' ¬∑ ' + dm.confRange[v] + '</div>' +
      '</div>' +
    '</div>' +
    /* MANDATORY DISCLAIMER ‚Äî every result card */
    '<div class="result-disclaimer">‚ö† ' + dm.disclaimer + '</div>' +
    /* SUMMARY */
    '<div class="summary-line">' + dm.summary[v] + '</div>' +
    /* HASHCHAIN STRIP */
    '<div class="hash-strip">' +
      '<div class="hash-strip-left">' +
        '<span class="hash-strip-icon">üîí</span>' +
        '<div class="hash-strip-texts">' +
          '<div class="hash-strip-label">' + dm.hashVerified + verStr + '</div>' +
          '<div class="hash-strip-val">' + trunc(r.hash) + '</div>' +
        '</div>' +
      '</div>' +
      '<button class="hash-copy-btn" onclick="copyHash()">' + dm.hashCopy + '</button>' +
      '<a class="hash-learn" href="#" onclick="event.preventDefault();document.getElementById(\'hash-popup\').classList.add(\'show\')">' + dm.hashLearn + '</a>' +
    '</div>' +
    /* CONFIDENCE */
    '<div class="conf-wrap">' +
      '<div class="conf-top"><span>' + DECISION_MAP[lang].rulesLabel.replace('TRIGGERED ','') + ' CONFIDENCE</span><span class="v' + v + '">' + conf + '%</span></div>' +
      '<div class="conf-bar"><div class="conf-fill fill' + v + '" id="conf-fill"></div></div>' +
      '<div class="conf-label ' + confLabel(conf,dm).cls + '">' + confLabel(conf,dm).label + '</div>' +
      '<div class="conf-note">' + dm.confNote + '</div>' +
    '</div>' +
    /* TRIGGERED RULES */
    '<div class="section-wrap">' +
      '<button class="collapsible-btn" onclick="toggle(\'ra\',\'rb\')">' +
        '<i class="arrow" id="ra">‚ñ∂</i> ' + dm.rulesLabel +
      '</button>' +
      '<div class="collapsible-body" id="rb">' + rulesHTML + '</div>' +
    '</div>' +
    /* TRACE */
    '<div class="section-wrap">' +
      '<button class="collapsible-btn" onclick="toggle(\'ta\',\'tb\')">' +
        '<i class="arrow" id="ta">‚ñ∂</i> üîí ' + dm.traceLabel +
      '</button>' +
      '<div class="trace-note">' + dm.traceNote + '</div>' +
      '<div class="trace-inner" id="tb">' + traceHTML + '</div>' +
    '</div>' +
    /* SHARE + COPY ‚Äî always visible */
    '<div class="actions-wrap">' +
      '<div class="actions-btns">' +
        '<button class="action-btn btn-share" onclick="shareResult()">' + dm.shareBtn + '</button>' +
        '<button class="action-btn btn-copy" onclick="copyProof()">' + dm.copyBtn + '</button>' +
      '</div>' +
      '<div class="actions-note">' + dm.actionsNote + '</div>' +
    '</div>' +
    /* SAFE NOTICE */
    '<div class="safe-notice">' + dm.safeNotice + '</div>' +
    /* FEEDBACK */
    '<div class="feedback-wrap">' +
      '<span class="feedback-lbl">' + dm.fbLabel + '</span>' +
      '<button class="fb-btn" id="fb-yes" onclick="giveFb(\'yes\')">' + dm.fbYes + '</button>' +
      '<button class="fb-btn" id="fb-no" onclick="giveFb(\'no\')">' + dm.fbNo + '</button>' +
      '<span class="fb-thanks" id="fb-thanks">' + dm.fbThanks + '</span>' +
      '<span class="fb-once">' + dm.fbOnce + '</span>' +
    '</div>';

  el.style.display = 'block';
  setTimeout(() => { const f = document.getElementById('conf-fill'); if(f) f.style.width = conf + '%'; }, 100);
  el.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

/* ‚ïê‚ïê HELPERS ‚ïê‚ïê */
function toggle(arrowId, bodyId) {
  const a = document.getElementById(arrowId);
  const b = document.getElementById(bodyId);
  if (a) a.classList.toggle('open');
  if (b) b.classList.toggle('open');
}

function copyHash() {
  if (!lastHash) return;
  navigator.clipboard.writeText(lastHash).then(() => showToast(DECISION_MAP[lang].hashCopied));
}

function buildProof() {
  if (!lastResult) return '';
  const r  = lastResult;
  const dm = DECISION_MAP[lang];
  return (
    'VERITAS GUARD ‚Äî RISK ANALYSIS\n' +
    '================================\n' +
    'Decision   : ' + dm.label[r.verdict] + '\n' +
    'Code       : ' + dm.code[r.verdict] + '\n' +
    'Confidence : ' + (r.confidence||0) + '%\n' +
    'Rules      : ' + ((r.fired_rules||[]).join(', ') || 'None') + '\n' +
    'Hash       : ' + (r.hash||'pending') + '\n' +
    'Engine     : ' + (engineVersion||'unknown') + ' ¬∑ RULES FROZEN\n' +
    'Time       : ' + new Date().toLocaleString() + '\n' +
    '================================\n' +
    'NOTE: Low risk does NOT mean safe.\n' +
    'veritasengine.in'
  );
}

function copyProof() {
  const text = buildProof();
  if (!text) return;
  navigator.clipboard.writeText(text).then(() => showToast(DECISION_MAP[lang].toastCopied));
}

function shareResult() {
  const text = buildProof();
  if (!text) return;
  if (navigator.share) {
    navigator.share({ title: 'Veritas Guard ‚Äî Risk Analysis', text });
  } else {
    navigator.clipboard.writeText(text).then(() => showToast(DECISION_MAP[lang].toastCopied));
  }
}

function showToast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 2500);
}

function giveFb(type) {
  const yes = document.getElementById('fb-yes');
  const no  = document.getElementById('fb-no');
  const thanks = document.getElementById('fb-thanks');
  if (!yes || !no) return;
  yes.disabled = true; no.disabled = true;
  yes.classList.toggle('selected', type === 'yes');
  no.classList.toggle('selected', type === 'no');
  if (thanks) thanks.classList.add('show');
}

function loadExample(i) {
  const inp = document.getElementById('input-text');
  inp.value = EXAMPLES[i];
  document.getElementById('char-val').textContent = EXAMPLES[i].length;
  inp.focus();
}

/* ‚ïê‚ïê LANG ‚ïê‚ïê */
function setLang(l) {
  lang = l;
  localStorage.setItem('vg_lang', l);
  applyLang();
}

function applyLang() {
  const t = T[lang];
  const map = {
    'tagline-text':t.tagline,'lbl-usecase':t.lblUsecase,'lbl-input':t.lblInput,
    'btn-text':t.btnText,'nd1':t.nd1,'nd2':t.nd2,'nd3':t.nd3,
    'lbl-total':t.lblTotal,'lbl-today':t.lblToday,
    'disc-title':t.discTitle,'disc-body':t.discBody,
    'trans-title':t.transTitle,'tr1':t.tr1,'tr2':t.tr2,'tr3':t.tr3,'tr4':t.tr4,
    'ex-title':t.exTitle,'ex-sub':t.exSub,'ex1':t.ex1,'ex2':t.ex2,'ex3':t.ex3
  };
  for (const [id, val] of Object.entries(map)) {
    const el = document.getElementById(id);
    if (el) el.textContent = val;
  }
  document.getElementById('input-text').placeholder = t.placeholder;
  document.querySelectorAll('#usecase option').forEach(o => {
    o.textContent = lang === 'hi' ? o.dataset.hi : o.dataset.en;
  });
  document.getElementById('btn-en').classList.toggle('active', lang === 'en');
  document.getElementById('btn-hi').classList.toggle('active', lang === 'hi');
  renderRateBar();
}

/* ‚ïê‚ïê DEV BYPASS ‚ïê‚ïê */
document.addEventListener('input', function(e) {
  if (e.target.id === 'input-text' && e.target.value.trim() === DEV_CODE) {
    const d = getRateData(); d.used = 0; saveRateData(d);
    e.target.value = '';
    document.getElementById('char-val').textContent = '0';
    renderRateBar();
    showToast('‚úÖ Dev: Limit reset!');
  }
});

/* ‚ïê‚ïê INIT ‚ïê‚ïê */
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('input-text').addEventListener('input', function() {
    document.getElementById('char-val').textContent = this.value.length;
  });
  document.getElementById('clear-btn').addEventListener('click', () => {
    document.getElementById('input-text').value = '';
    document.getElementById('char-val').textContent = '0';
    document.getElementById('result-card').style.display = 'none';
    lastResult = null; lastHash = '';
  });
  applyLang();
  checkHealth();
  loadStats();
});
</script>
</body>
</html>
