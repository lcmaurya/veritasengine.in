<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Cache-Control" content="no-store" />
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Veritas Guard</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ°Ô∏è</text></svg>">
<style>
/* üé® UI Styles (‡§µ‡§π‡•Ä ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§ñ‡•Ç‡§¨‡§∏‡•Ç‡§∞‡§§‡•Ä) */
body { margin:0; font-family:system-ui; background:#0b1220; color:#e5e7eb; }
#legal-marquee { background:#7c2d12; color:#fff; padding:8px 0; font-size:14px; }
#app { max-width:480px; margin:40px auto; background:#0f172a; border-radius:12px; padding:20px; box-shadow:0 0 40px rgba(0,0,0,.5); }
h1 { text-align:center; margin:0 0 6px; }
.tagline { text-align:center; font-size:13px; color:#9ca3af; }
textarea { width:100%; height:100px; margin-top:16px; border-radius:8px; border:1px solid #334155; padding:12px; background:#020617; color:#e5e7eb; box-sizing: border-box; resize: none; transition: all 0.3s ease; }
textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 15px rgba(59, 130, 246, 0.4); }
.btn-primary { width:100%; margin-top:12px; padding:14px; border:none; cursor:pointer; border-radius:8px; background:#2563eb; color:white; font-size:16px; font-weight:bold; transition: background 0.2s ease; }
.btn-primary:hover { background: #1d4ed8; }
@keyframes fadeInSlideUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
#resultSection { display: none; margin-top: 20px; background: #1e293b; padding: 15px; border-radius: 8px; border: 1px solid #334155; animation: fadeInSlideUp 0.4s ease-out; }
.risk-badge { display: inline-block; padding: 6px 12px; border-radius: 4px; font-weight: bold; font-size: 14px; margin-bottom: 10px; }
.explanation { font-size: 14px; margin-bottom: 12px; line-height:1.5; }
.signals-list { margin: 0; padding-left: 20px; color: #9ca3af; font-size: 13px; }
.hash-display { margin-top: 12px; font-family: monospace; font-size: 10px; color: #64748b; word-break: break-all; background: #020617; padding: 8px; border-radius: 4px; border: 1px dashed #334155;}
.action-row { display: flex; gap: 10px; margin-top: 15px; }
.action-btn { flex: 1; padding: 10px; border: none; border-radius: 6px; font-size: 13px; cursor: pointer; font-weight: bold; transition: opacity 0.2s ease; }
.btn-share { background: #10b981; color: white; }
.btn-clear { background: #ef4444; color: white; }
.btn-voice { background: #f59e0b; color: white; }
.lang-btn { padding:6px 12px; margin-left:4px; border-radius:6px; font-size:13px; border:none; cursor:pointer; background:#3b82f6; color:white;}
</style>
</head>

<body>
<div style="position:fixed;top:12px;right:12px;z-index:9999;">
  <button class="lang-btn" onclick="applyLang('en')">EN</button>
  <button class="lang-btn" onclick="applyLang('hi')">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
</div>
<marquee id="legal-marquee"></marquee>
<div id="app">
  <h1>üõ°Ô∏è Veritas Guard</h1>
  <div class="tagline" id="tagline"></div>
  <textarea id="input-text"></textarea>
  <button class="btn-primary" id="main-btn" onclick="analyzeText()"><span id="analyze-btn"></span></button>
  <div id="resultSection">
      <div id="riskBadge" class="risk-badge">SCANNING...</div>
      <div id="explainText" class="explanation"></div>
      <div style="font-size: 12px; color: #9ca3af; font-weight: bold; margin-bottom:4px;" id="signal-title">Triggered Signals:</div>
      <ul id="signalsList" class="signals-list"></ul>
      <div id="hashDisplay" class="hash-display"></div>
      <div class="action-row">
          <button class="action-btn btn-voice" onclick="playVoiceWarning()">üîä <span id="btn-voice-txt">Listen</span></button>
          <button class="action-btn btn-share" onclick="shareResult()">üì≤ <span id="btn-share-txt">Share</span></button>
          <button class="action-btn btn-clear" onclick="location.reload()">üóëÔ∏è <span id="btn-clear-txt">Clear</span></button>
      </div>
  </div>
  <div style="font-size:12px;color:#9ca3af;margin-top:10px;text-align:center">üîí No Login ¬∑ No Permissions ¬∑ No Data Stored</div>
</div>
<footer>¬© Veritas Engine ‚Äî Open Risk Awareness Tool</footer>

<script>
// üöÄ THE NEW PERMANENT TUNNEL (Your Paid Pinggy Link)
const API_URL = "https://hsyntygyto.a.pinggy.link/api/scan"; 

const I18N = {
  en:{
    tagline:"Explain risk. Don‚Äôt demand trust.", placeholder:"Paste SMS, WhatsApp message, or link here...", button:"Analyze Risk Signals",
    marquee:"‚ö†Ô∏è This tool analyzes text for known risk patterns. Final responsibility remains with the user.",
    shareTxt: "Share", clearTxt: "Clear", listenTxt: "Listen", signalTitle: "Triggered Signals:",
    voiceWarning: "Warning! This message shows signs of a scam. Please do not click any links.",
    voiceSafe: "This message appears safe, but always stay alert."
  },
  hi:{
    tagline:"‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Æ‡§ù‡§æ‡§á‡§è‡•§ ‡§≠‡§∞‡•ã‡§∏‡§æ ‡§Æ‡§§ ‡§Æ‡§æ‡§Ç‡§ó‡§ø‡§è‡•§", placeholder:"SMS, WhatsApp ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç‚Ä¶", button:"‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç",
    marquee:"‚ö†Ô∏è ‡§Ø‡§π ‡§ü‡•Ç‡§≤ ‡§ï‡•á‡§µ‡§≤ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§º‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§π‡•à‡•§",
    shareTxt: "‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç", clearTxt: "‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç", listenTxt: "‡§∏‡•Å‡§®‡•á", signalTitle: "‡§ñ‡§§‡§∞‡•á ‡§ï‡•á ‡§∏‡§Ç‡§ï‡•á‡§§:",
    voiceWarning: "‡§∏‡§æ‡§µ‡§ß‡§æ‡§®! ‡§Ø‡§π ‡§è‡§ï ‡§´‡§∞‡•ç‡§ú‡•Ä ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§",
    voiceSafe: "‡§Ø‡§π ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡•ç‡§∞‡§§‡•Ä‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§∏‡§§‡§∞‡•ç‡§ï ‡§∞‡§π‡•á‡§Ç‡•§"
  }
};

let currentLang = "en";
let currentRiskLevel = 0;

function applyLang(lang){
  currentLang = lang;
  document.getElementById("tagline").innerText = I18N[lang].tagline;
  document.getElementById("input-text").placeholder = I18N[lang].placeholder;
  document.getElementById("analyze-btn").innerText = I18N[lang].button;
  document.getElementById("legal-marquee").innerText = I18N[lang].marquee;
  document.getElementById("btn-share-txt").innerText = I18N[lang].shareTxt;
  document.getElementById("btn-clear-txt").innerText = I18N[lang].clearTxt;
  document.getElementById("btn-voice-txt").innerText = I18N[lang].listenTxt;
  document.getElementById("signal-title").innerText = I18N[lang].signalTitle;
}

window.onload = () => applyLang('en');

async function analyzeText() {
    let rawInput = document.getElementById('input-text').value.trim();
    if(!rawInput) return;

    // üîí DATA MASKING (ChatGPT ‡§®‡•á ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§•‡§æ, ‡§Æ‡•à‡§Ç‡§®‡•á ‡§µ‡§æ‡§™‡§∏ ‡§ú‡•ã‡•ú ‡§¶‡§ø‡§Ø‡§æ)
    let maskedInput = rawInput.replace(/\b\d{8,14}\b/g, (match) => "X".repeat(match.length - 4) + match.slice(-4));
    
    const mainBtn = document.getElementById('main-btn');
    const resultSec = document.getElementById('resultSection');
    
    mainBtn.disabled = true; 
    resultSec.style.display = "none";

    try {
        const response = await fetch(API_URL, {
            method: "POST", 
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ text: maskedInput }) 
        });
        
        const data = await response.json();
        currentRiskLevel = data.verdict;
        
        const colors = ["#10b981", "#eab308", "#f97316", "#ef4444"];
        const bgs = ["rgba(16,185,129,0.1)", "rgba(234,179,8,0.1)", "rgba(249,115,22,0.1)", "rgba(239,68,68,0.1)"];
        const labels = ["SAFE", "NEEDS ATTENTION", "RISK", "HIGH RISK"];
        
        const badge = document.getElementById('riskBadge');
        badge.innerText = labels[currentRiskLevel];
        badge.style.color = colors[currentRiskLevel];
        badge.style.backgroundColor = bgs[currentRiskLevel];
        badge.style.border = `1px solid ${colors[currentRiskLevel]}`;
        
        document.getElementById('explainText').innerText = data.explain_text;
        document.getElementById('signalsList').innerHTML = data.fired_rules.map(r => `<li>${r.replace(/_/g, " ")}</li>`).join("");
        document.getElementById('hashDisplay').innerText = "Audit Hash: " + data.audit_hash;
        
        resultSec.style.display = "block";
        if(currentRiskLevel >= 2) playVoiceWarning();

    } catch (e) {
        alert("Engine unreachable. Check Termux!");
    } finally {
        mainBtn.disabled = false;
    }
}

function playVoiceWarning() {
    window.speechSynthesis.cancel(); 
    const msg = currentRiskLevel >= 2 ? I18N[currentLang].voiceWarning : I18N[currentLang].voiceSafe;
    const utterance = new SpeechSynthesisUtterance(msg);
    utterance.lang = currentLang === 'hi' ? 'hi-IN' : 'en-US';
    window.speechSynthesis.speak(utterance);
}

function shareResult() {
    const text = `Veritas Guard Scan Result: ${document.getElementById('riskBadge').innerText}\nHash: ${document.getElementById('hashDisplay').innerText}`;
    if (navigator.share) { navigator.share({ title: 'Veritas Scan', text: text }); }
}
</script>
</body>
</html>
