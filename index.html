<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-store">
<title>Veritas Guard</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap');

:root {
  --bg: #060910;
  --surface: #0d1117;
  --border: #1e2d3d;
  --accent: #00d4ff;
  --accent2: #ff4d6d;
  --accent3: #00ff9d;
  --warn: #ffaa00;
  --text: #c9d1d9;
  --muted: #586069;
  --verdict-0: #00ff9d;
  --verdict-1: #ffaa00;
  --verdict-2: #ff7043;
  --verdict-3: #ff4d6d;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Syne', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
}

/* Grid background */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    linear-gradient(rgba(0,212,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,212,255,0.03) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
  z-index: 0;
}

/* Top warning bar */
#warning-bar {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 100;
  background: rgba(255,77,109,0.25);
  border-bottom: 2px solid rgba(255,77,109,0.6);
  padding: 8px 0;
  font-family: 'Space Mono', monospace;
  font-size: 13px;
  color: #ffffff;
  overflow: hidden;
  backdrop-filter: blur(10px);
}
#warn-text {
  display: inline-block;
  white-space: nowrap;
  animation: marquee 18s linear infinite;
  padding-left: 100%;
}
@keyframes marquee {
  0%   { transform: translateX(0); }
  100% { transform: translateX(-200%); }
}

#warning-bar::before {
  content: '‚ö†';
  font-size: 14px;
  flex-shrink: 0;
}

/* Main container */
#app {
  position: relative;
  z-index: 1;
  max-width: 480px;
  margin: 0 auto;
  padding: 70px 16px 40px;
}

/* Header */
.header {
  text-align: center;
  padding: 24px 0 20px;
}

.logo {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}

.logo-icon {
  width: 42px; height: 42px;
  background: linear-gradient(135deg, var(--accent), #0051ff);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 22px;
  box-shadow: 0 0 20px rgba(0,212,255,0.3);
}

.logo-text {
  font-size: 26px;
  font-weight: 800;
  letter-spacing: -0.5px;
  background: linear-gradient(90deg, var(--accent), #ffffff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.tagline {
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--muted);
  letter-spacing: 2px;
  text-transform: uppercase;
}

/* Stats bar */
.stats-bar {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 16px 0 20px;
  padding: 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
}

.stat {
  text-align: center;
}

.stat-val {
  font-family: 'Space Mono', monospace;
  font-size: 15px;
  font-weight: 700;
  color: var(--accent);
}

.stat-label {
  font-size: 10px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Card */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 12px;
}

/* Language toggle */
.lang-toggle {
  display: flex;
  gap: 6px;
  margin-bottom: 14px;
}

.lang-btn {
  flex: 1;
  padding: 8px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--muted);
  font-family: 'Space Mono', monospace;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
}

.lang-btn.active {
  background: rgba(0,212,255,0.1);
  border-color: var(--accent);
  color: var(--accent);
}

/* Select */
.field-label {
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 6px;
  font-family: 'Space Mono', monospace;
}

select {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  font-family: 'Syne', sans-serif;
  font-size: 14px;
  margin-bottom: 14px;
  outline: none;
  transition: border-color 0.2s;
}

select:focus { border-color: var(--accent); }

/* Textarea */
textarea {
  width: 100%;
  height: 100px;
  padding: 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  font-family: 'Space Mono', monospace;
  font-size: 12px;
  resize: none;
  outline: none;
  transition: border-color 0.2s;
  line-height: 1.6;
}

textarea:focus { border-color: var(--accent); }
textarea::placeholder { color: var(--muted); }

/* Char counter */
.char-count {
  text-align: right;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  margin-top: 4px;
  margin-bottom: 14px;
}

/* Analyze button */
#analyze-btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, var(--accent), #0051ff);
  border: none;
  border-radius: 8px;
  color: #000;
  font-family: 'Syne', sans-serif;
  font-weight: 800;
  font-size: 15px;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}

#analyze-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 24px rgba(0,212,255,0.3);
}

#analyze-btn:active { transform: translateY(0); }

#analyze-btn.loading {
  pointer-events: none;
  opacity: 0.7;
}

/* No data notice */
.no-data {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 12px;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
}

.no-data span::before { content: '‚úì '; color: var(--accent3); }

/* Result card */
#result-card {
  display: none;
  background: var(--surface);
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 12px;
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.result-header {
  padding: 16px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.verdict-icon {
  width: 48px; height: 48px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 22px;
  flex-shrink: 0;
}

.verdict-text h3 {
  font-size: 18px;
  font-weight: 800;
}

.verdict-text p {
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  margin-top: 2px;
}

/* Confidence bar */
.confidence-section {
  padding: 0 20px 14px;
}

.confidence-label {
  display: flex;
  justify-content: space-between;
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 6px;
}

.confidence-bar {
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}

.confidence-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  width: 0%;
}

/* Reasons */
.reasons-section {
  padding: 0 20px 16px;
}

.reasons-title {
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}

.reason-tag {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 20px;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  margin: 3px 3px 3px 0;
  border: 1px solid;
}

/* Hash section */
.hash-section {
  padding: 12px 20px;
  background: rgba(0,0,0,0.3);
  border-top: 1px solid var(--border);
}

.hash-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  margin-bottom: 4px;
}

.hash-key { color: var(--muted); }
.hash-val { color: var(--accent); word-break: break-all; max-width: 60%; text-align: right; }

/* Disclaimer */
.disclaimer {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 12px;
}

.disclaimer summary {
  padding: 12px 16px;
  font-family: 'Space Mono', monospace;
  font-size: 11px;
  color: var(--muted);
  cursor: pointer;
  list-style: none;
  display: flex;
  justify-content: space-between;
}

.disclaimer summary::after { content: '‚Üì'; }
.disclaimer[open] summary::after { content: '‚Üë'; }

.disclaimer-body {
  padding: 0 16px 14px;
  font-size: 12px;
  color: var(--muted);
  line-height: 1.7;
  border-top: 1px solid var(--border);
  padding-top: 12px;
}

/* Footer */
footer {
  text-align: center;
  font-family: 'Space Mono', monospace;
  font-size: 10px;
  color: var(--muted);
  padding-bottom: 20px;
}

footer span { color: var(--accent); }

/* Verdict colors */
.v0 { color: var(--verdict-0); border-color: rgba(0,255,157,0.2); background: rgba(0,255,157,0.08); }
.v1 { color: var(--verdict-1); border-color: rgba(255,170,0,0.2); background: rgba(255,170,0,0.08); }
.v2 { color: var(--verdict-2); border-color: rgba(255,112,67,0.2); background: rgba(255,112,67,0.08); }
.v3 { color: var(--verdict-3); border-color: rgba(255,77,109,0.2); background: rgba(255,77,109,0.08); }

.bg-v0 { background: rgba(0,255,157,0.15); }
.bg-v1 { background: rgba(255,170,0,0.15); }
.bg-v2 { background: rgba(255,112,67,0.15); }
.bg-v3 { background: rgba(255,77,109,0.15); }

.fill-v0 { background: var(--verdict-0); }
.fill-v1 { background: var(--verdict-1); }
.fill-v2 { background: var(--verdict-2); }
.fill-v3 { background: var(--verdict-3); }
</style>
</head>
<body>

<div id="warning-bar">
  <span id="warn-text">This tool analyzes text for known risk patterns. It does NOT confirm fraud. Final responsibility remains with the user.</span>
</div>

<div id="app">

  <div class="header">
    <div class="logo">
      <div class="logo-icon">üõ°Ô∏è</div>
      <div class="logo-text" id="logo-title">Veritas Guard</div>
    </div>
    <div class="tagline" id="tagline-text">EXPLAIN RISK ¬∑ DON'T DEMAND TRUST</div>
  </div>

  <div class="stats-bar">
    <div class="stat">
      <div class="stat-val" id="stat-scanned">0</div>
      <div class="stat-label" id="stat-scanned-label">Scanned</div>
    </div>
    <div class="stat">
      <div class="stat-val" id="stat-flagged">0</div>
      <div class="stat-label" id="stat-flagged-label">Flagged</div>
    </div>
    <div class="stat">
      <div class="stat-val">15</div>
      <div class="stat-label" id="stat-patterns-label">Patterns</div>
    </div>
    <div class="stat">
      <div class="stat-val">v1.0</div>
      <div class="stat-label">Engine</div>
    </div>
  </div>

  <div class="card">
    <div class="lang-toggle">
      <button class="lang-btn active" id="btn-en">EN</button>
      <button class="lang-btn" id="btn-hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
    </div>

    <div class="field-label" id="label-usecase">USE CASE</div>
    <select id="usecase">
      <option value="cyber" data-en="Cyber / Fraud" data-hi="‡§∏‡§æ‡§á‡§¨‡§∞ / ‡§´‡•ç‡§∞‡•â‡§°">Cyber / Fraud</option>
      <option value="banking" data-en="Banking / Fintech" data-hi="‡§¨‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó / ‡§´‡§ø‡§®‡§ü‡•á‡§ï">Banking / Fintech</option>
      <option value="legal" data-en="Legal / Compliance" data-hi="‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä / ‡§Ö‡§®‡•Å‡§™‡§æ‡§≤‡§®">Legal / Compliance</option>
      <option value="health" data-en="Healthcare" data-hi="‡§π‡•á‡§≤‡•ç‡§•‡§ï‡•á‡§Ø‡§∞">Healthcare</option>
      <option value="insurance" data-en="Insurance" data-hi="‡§¨‡•Ä‡§Æ‡§æ">Insurance</option>
      <option value="govt" data-en="Government / Public" data-hi="‡§∏‡§∞‡§ï‡§æ‡§∞‡•Ä / ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï">Government / Public</option>
      <option value="ecom" data-en="E-commerce" data-hi="‡§à-‡§ï‡•â‡§Æ‡§∞‡•ç‡§∏">E-commerce</option>
      <option value="edu" data-en="Education / Research" data-hi="‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ / ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§®">Education / Research</option>
      <option value="enterprise" data-en="Enterprise Security" data-hi="‡§è‡§Ç‡§ü‡§∞‡§™‡•ç‡§∞‡§æ‡§á‡§ú ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ">Enterprise Security</option>
    </select>

    <div class="field-label" id="label-input">MESSAGE / SMS / LINK</div>
    <textarea id="input-text" placeholder="Paste SMS, WhatsApp message, or link here..."></textarea>
    <div class="char-count" style="display:flex;justify-content:space-between;align-items:center;">
      <button onclick="clearText()" style="background:transparent;border:1px solid var(--border);color:var(--muted);padding:3px 10px;border-radius:5px;font-size:11px;cursor:pointer;font-family:'Space Mono',monospace;" id="clear-btn">‚úï CLEAR</button>
      <span><span id="char-val">0</span> / 1000</span>
    </div>

    <button id="analyze-btn">
      <span id="btn-text">‚ö° ANALYZE RISK SIGNALS</span>
    </button>

    <div class="no-data">
      <span id="nd1">No Login</span>
      <span id="nd2">No Permissions</span>
      <span id="nd3">No Data Stored</span>
    </div>
  </div>

  <!-- Result -->
  <div id="result-card"></div>

  <!-- Disclaimer -->
  <details class="disclaimer">
    <summary id="disclaimer-title">Legal Disclaimer</summary>
    <div class="disclaimer-body" id="disclaimer-body">
      This tool analyzes text for commonly known risk patterns based on deterministic rules.
      It does not guarantee fraud detection accuracy and does not make decisions for you.
      Final responsibility always remains with the user.
    </div>
  </details>

  <footer>
    ¬© <span>Veritas Engine</span> ‚Äî Open Risk Awareness Tool
  </footer>

</div>

<script>
// ‚îÄ‚îÄ VERITAS ENGINE CONNECTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Jab server ready ho ‚Äî YOUR_ENGINE_URL ki jagah apna URL daalo

  const ENGINE_URL = "https://api.veritasengine.in/decide";

async function callEngine(inputText) {
  try {
    const res = await fetch(ENGINE_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ input: inputText })
    });
    const data = await res.json();
    return {
      verdict: data.verdict,          // 0 | 1 | 2 | 3
      confidence: data.confidence,
      fired_rules: data.fired_rules || [],
      proof_hash: data.hash || "pending",
      dsc: data.dsc || null
    };
  } catch(e) {
    return null; // connection fail
  }
}

// ‚îÄ‚îÄ UI Logic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let lang = localStorage.getItem('v_lang') || 'en';
let scanCount = parseInt(localStorage.getItem('v_scan') || '0');
let flagCount = parseInt(localStorage.getItem('v_flag') || '0');

const T = {
  en: {
    warn: "‚ö† This tool analyzes text for known risk patterns. It does NOT confirm fraud. Final responsibility remains with the user.",
    tagline: "EXPLAIN RISK ¬∑ DON'T DEMAND TRUST",
    labelUsecase: "USE CASE",
    labelInput: "MESSAGE / SMS / LINK",
    placeholder: "Paste SMS, WhatsApp message, or link here...",
    btnText: "‚ö° ANALYZE RISK SIGNALS",
    nd1: "No Login", nd2: "No Permissions", nd3: "No Data Stored",
    scanned: "Scanned", flagged: "Flagged", patterns: "Patterns",
    disclaimerTitle: "Legal Disclaimer",
    disclaimerBody: "This tool analyzes text for commonly known risk patterns based on deterministic rules. It does not guarantee fraud detection accuracy and does not make decisions for you. Final responsibility always remains with the user.",
    verdictLabels: ["GENUINE / NORMAL", "NEEDS ATTENTION", "SUSPICIOUS", "FRAUD LIKELY"],
    verdictDesc: ["No risk patterns detected", "Minor signals found ‚Äî stay alert", "Multiple risk signals detected", "High risk ‚Äî do not proceed"],
    verdictEmoji: ["‚úÖ", "‚ö†Ô∏è", "üî∂", "üö®"],
    confidenceLabel: "CONFIDENCE SCORE",
    reasonsLabel: "TRIGGERED PATTERNS",
    hashLabel: "PROOF HASH",
    timeLabel: "TIMESTAMP",
    noReasons: "No specific patterns triggered",
    analyzing: "ANALYZING...",
    shareTitle: "SHARE REPORT",
    btnCopy: "üìã Copy Text",
    btnPdf: "üìÑ Download PDF",
    btnShare: "üì§ Share",
    copied: "Copied!",
    reportTitle: "VERITAS GUARD ‚Äî RISK ANALYSIS REPORT",
    reportEngine: "Engine: Veritas Engine v1.0",
    reportPatterns: "Patterns Checked: 15",
    reportVerdict: "VERDICT",
    reportConfidence: "Confidence",
    reportTriggered: "Triggered Patterns",
    reportHash: "Proof Hash",
    reportTime: "Timestamp",
    reportFooter: "This report is generated by Veritas Guard. Final responsibility remains with the user.",
    reportNone: "None"
  },
  hi: {
    warn: "‚ö† ‡§Ø‡§π ‡§ü‡•Ç‡§≤ ‡§ï‡•á‡§µ‡§≤ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§º‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§π‡•à‡•§",
    tagline: "‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Æ‡§ù‡§æ‡§á‡§è ¬∑ ‡§≠‡§∞‡•ã‡§∏‡§æ ‡§Æ‡§§ ‡§Æ‡§æ‡§Ç‡§ó‡§ø‡§è",
    labelUsecase: "‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞",
    labelInput: "‡§∏‡§Ç‡§¶‡•á‡§∂ / SMS / ‡§≤‡§ø‡§Ç‡§ï",
    placeholder: "SMS, WhatsApp ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§æ ‡§≤‡§ø‡§Ç‡§ï ‡§Ø‡§π‡§æ‡§Å ‡§ö‡§ø‡§™‡§ï‡§æ‡§è‡§Å...",
    btnText: "‚ö° ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç",
    nd1: "‡§ï‡•ã‡§à ‡§≤‡•â‡§ó‡§ø‡§® ‡§®‡§π‡•Ä‡§Ç", nd2: "‡§ï‡•ã‡§à ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§®‡§π‡•Ä‡§Ç", nd3: "‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç",
    scanned: "‡§ú‡§æ‡§Ç‡§ö‡•á ‡§ó‡§è", flagged: "‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß", patterns: "‡§™‡•à‡§ü‡§∞‡•ç‡§®",
    disclaimerTitle: "‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§∞‡§£",
    disclaimerBody: "‡§Ø‡§π ‡§ü‡•Ç‡§≤ ‡§ï‡•á‡§µ‡§≤ ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§ú‡•ç‡§û‡§æ‡§§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§¶‡•á‡§§‡§æ ‡§î‡§∞ ‡§ï‡•ã‡§à ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§≤‡•á‡§§‡§æ‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§º‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§",
    verdictLabels: ["‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø / ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï", "‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç", "‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß", "‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§∏‡§Ç‡§≠‡§µ"],
    verdictDesc: ["‡§ï‡•ã‡§à ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ", "‡§õ‡•ã‡§ü‡•á ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á ‚Äî ‡§∏‡§§‡§∞‡•ç‡§ï ‡§∞‡§π‡•á‡§Ç", "‡§ï‡§à ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á", "‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‚Äî ‡§Ü‡§ó‡•á ‡§® ‡§¨‡§¢‡§º‡•á‡§Ç"],
    verdictEmoji: ["‚úÖ", "‚ö†Ô∏è", "üî∂", "üö®"],
    confidenceLabel: "‡§Ü‡§§‡•ç‡§Æ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§∏‡•ç‡§ï‡•ã‡§∞",
    reasonsLabel: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§™‡•à‡§ü‡§∞‡•ç‡§®",
    hashLabel: "‡§™‡•ç‡§∞‡•Ç‡§´ ‡§π‡•à‡§∂",
    timeLabel: "‡§∏‡§Æ‡§Ø",
    noReasons: "‡§ï‡•ã‡§à ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ",
    analyzing: "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
    shareTitle: "‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç",
    btnCopy: "üìã ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç",
    btnPdf: "üìÑ PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
    btnShare: "üì§ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç",
    copied: "‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ!",
    reportTitle: "‡§µ‡•á‡§∞‡§ø‡§ü‡§æ‡§∏ ‡§ó‡§æ‡§∞‡•ç‡§° ‚Äî ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü",
    reportEngine: "‡§á‡§Ç‡§ú‡§®: Veritas Engine v1.0",
    reportPatterns: "‡§ú‡§æ‡§Ç‡§ö‡•á ‡§ó‡§è ‡§™‡•à‡§ü‡§∞‡•ç‡§®: 15",
    reportVerdict: "‡§®‡§ø‡§∞‡•ç‡§£‡§Ø",
    reportConfidence: "‡§Ü‡§§‡•ç‡§Æ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏",
    reportTriggered: "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§™‡•à‡§ü‡§∞‡•ç‡§®",
    reportHash: "‡§™‡•ç‡§∞‡•Ç‡§´ ‡§π‡•à‡§∂",
    reportTime: "‡§∏‡§Æ‡§Ø",
    reportFooter: "‡§Ø‡§π ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§µ‡•á‡§∞‡§ø‡§ü‡§æ‡§∏ ‡§ó‡§æ‡§∞‡•ç‡§° ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡•§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ú‡§º‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§π‡•à‡•§",
    reportNone: "‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç"
  }
};

function setLang(l) {
  lang = l;
  localStorage.setItem('v_lang', l);
  applyLang();
}

function applyLang() {
  const t = T[lang];
  document.getElementById('warn-text').textContent = t.warn;
  document.getElementById('tagline-text').textContent = t.tagline;
  document.getElementById('label-usecase').textContent = t.labelUsecase;
  document.getElementById('label-input').textContent = t.labelInput;
  document.getElementById('input-text').placeholder = t.placeholder;
  document.getElementById('btn-text').textContent = t.btnText;
  document.getElementById('nd1').textContent = t.nd1;
  document.getElementById('nd2').textContent = t.nd2;
  document.getElementById('nd3').textContent = t.nd3;
  document.getElementById('stat-scanned-label').textContent = t.scanned;
  document.getElementById('stat-flagged-label').textContent = t.flagged;
  document.getElementById('stat-patterns-label').textContent = t.patterns;
  document.getElementById('disclaimer-title').textContent = t.disclaimerTitle;
  document.getElementById('disclaimer-body').textContent = t.disclaimerBody;

  // Select options
  document.querySelectorAll('#usecase option').forEach(o => {
    o.textContent = lang === 'hi' ? o.dataset.hi : o.dataset.en;
  });

  document.getElementById('btn-en').classList.toggle('active', lang === 'en');
  document.getElementById('btn-hi').classList.toggle('active', lang === 'hi');
}

// Char counter
document.getElementById('input-text').addEventListener('input', function() {
  document.getElementById('char-val').textContent = this.value.length;
});

function updateStats() {
  document.getElementById('stat-scanned').textContent = scanCount;
  document.getElementById('stat-flagged').textContent = flagCount;
}

async function analyze() {
  const text = document.getElementById('input-text').value.trim();
  const t = T[lang];

  if (!text) {
    document.getElementById('input-text').style.borderColor = 'var(--accent2)';
    setTimeout(() => document.getElementById('input-text').style.borderColor = '', 1000);
    return;
  }

  const btn = document.getElementById('analyze-btn');
  btn.classList.add('loading');
  document.getElementById('btn-text').textContent = t.analyzing;

  setTimeout(async () => {
    const r = await callEngine(text);

    if (!r) {
      alert(lang === 'hi' ? '‡§á‡§Ç‡§ú‡§® ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ URL ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§' : 'Engine not connected. Set YOUR_ENGINE_URL.');
      btn.classList.remove('loading');
      document.getElementById('btn-text').textContent = t.btnText;
      return;
    }

    if (r.verdict === null || r.verdict === undefined) {
      alert(lang === 'hi' ? '‡§á‡§Ç‡§ú‡§® ‡§Ö‡§≠‡•Ä ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§' : 'Engine not connected yet.');
      btn.classList.remove('loading');
      document.getElementById('btn-text').textContent = t.btnText;
      return;
    }

    scanCount++;
    if (r.verdict >= 2) flagCount++;
    localStorage.setItem('v_scan', scanCount);
    localStorage.setItem('v_flag', flagCount);
    updateStats();

    showResult(r, t);
    window._lastResult = r;

    btn.classList.remove('loading');
    document.getElementById('btn-text').textContent = t.btnText;
  }, 600);
}

function showResult(r, t) {
  const v = r.verdict;
  const vClass = `v${v}`;
  const bgClass = `bg-v${v}`;
  const fillClass = `fill-v${v}`;

  const reasons = r.fired_rules.length > 0
    ? r.fired_rules.map(rule => `<span class="reason-tag ${vClass}">${rule}</span>`).join('')
    : `<span class="reason-tag" style="color:var(--muted);border-color:var(--border)">${t.noReasons}</span>`;

  const now = new Date().toLocaleString();

  document.getElementById('result-card').innerHTML = `
    <div class="result-header ${bgClass}">
      <div class="verdict-icon ${bgClass}" style="border: 2px solid currentColor" class="${vClass}">
        ${t.verdictEmoji[v]}
      </div>
      <div class="verdict-text">
        <h3 class="${vClass}">${t.verdictLabels[v]}</h3>
        <p>${t.verdictDesc[v]}</p>
      </div>
    </div>

    <div class="confidence-section">
      <div class="confidence-label">
        <span>${t.confidenceLabel}</span>
        <span class="${vClass}">${r.confidence}%</span>
      </div>
      <div class="confidence-bar">
        <div class="confidence-fill ${fillClass}" id="conf-fill"></div>
      </div>
    </div>

    <div class="reasons-section">
      <div class="reasons-title">${t.reasonsLabel}</div>
      ${reasons}
    </div>

    <div class="hash-section">
      <div class="hash-row">
        <span class="hash-key">${t.hashLabel}</span>
        <span class="hash-val">${r.proof_hash}</span>
      </div>
      <div class="hash-row">
        <span class="hash-key">${t.timeLabel}</span>
        <span class="hash-val" style="color:var(--muted)">${now}</span>
      </div>
    </div>

    <div style="padding:14px 20px;border-top:1px solid var(--border);">
      <div style="font-family:'Space Mono',monospace;font-size:10px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;">${t.shareTitle}</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button id="copy-btn" onclick="copyText()" style="flex:1;min-width:100px;padding:9px 8px;background:transparent;border:1px solid var(--border);border-radius:7px;color:var(--text);font-family:'Space Mono',monospace;font-size:11px;cursor:pointer;">${t.btnCopy}</button>
        <button id="pdf-btn" onclick="downloadPdf()" style="flex:1;min-width:100px;padding:9px 8px;background:transparent;border:1px solid var(--border);border-radius:7px;color:var(--text);font-family:'Space Mono',monospace;font-size:11px;cursor:pointer;">${t.btnPdf}</button>
        <button id="share-btn" onclick="shareText()" style="flex:1;min-width:100px;padding:9px 8px;background:rgba(0,212,255,0.1);border:1px solid var(--accent);border-radius:7px;color:var(--accent);font-family:'Space Mono',monospace;font-size:11px;cursor:pointer;">${t.btnShare}</button>
      </div>
    </div>
  `;

  document.getElementById('result-card').style.display = 'block';

  // Animate confidence bar
  setTimeout(() => {
    const fill = document.getElementById('conf-fill');
    if (fill) fill.style.width = r.confidence + '%';
  }, 100);

  document.getElementById('result-card').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function buildReportText(r, t, inputText, usecase) {
  const patterns = r.fired_rules.length > 0 ? r.fired_rules.join(', ') : t.reportNone;
  return `
${t.reportTitle}
${'='.repeat(40)}
${t.reportEngine}
${t.reportPatterns}
${t.timeLabel}: ${new Date().toLocaleString()}

${t.reportVerdict}: ${t.verdictEmoji[r.verdict]} ${t.verdictLabels[r.verdict]}
${t.reportConfidence}: ${r.confidence}%
${t.reportTriggered}: ${patterns}
${t.reportHash}: ${r.proof_hash}

--- ${lang === 'hi' ? '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§ø‡§§ ‡§∏‡§Ç‡§¶‡•á‡§∂' : 'Analyzed Message'} ---
${inputText}

${'='.repeat(40)}
${t.reportFooter}
  `.trim();
}

function shareText() {
  const t = T[lang];
  if (!window._lastResult) return;
  const inputText = document.getElementById('input-text').value.trim();
  const usecase = document.getElementById('usecase').value;
  const text = buildReportText(window._lastResult, t, inputText, usecase);

  if (navigator.share) {
    navigator.share({ title: t.reportTitle, text: text });
  } else {
    navigator.clipboard.writeText(text).then(() => {
      const btn = document.getElementById('share-btn');
      btn.textContent = t.copied;
      setTimeout(() => btn.textContent = t.btnShare, 2000);
    });
  }
}

function copyText() {
  const t = T[lang];
  if (!window._lastResult) return;
  const inputText = document.getElementById('input-text').value.trim();
  const text = buildReportText(window._lastResult, t, inputText, '');
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copy-btn');
    btn.textContent = t.copied;
    setTimeout(() => btn.textContent = t.btnCopy, 2000);
  });
}

function downloadPdf() {
  const t = T[lang];
  if (!window._lastResult) return;
  const r = window._lastResult;
  const inputText = document.getElementById('input-text').value.trim();
  const now = new Date().toLocaleString();
  const patterns = r.fired_rules.length > 0 ? r.fired_rules.join(', ') : t.reportNone;

  const html = `<!DOCTYPE html><html><head><meta charset="UTF-8">
  <style>
    body{font-family:Arial,sans-serif;max-width:600px;margin:40px auto;padding:20px;color:#111;}
    h1{font-size:18px;border-bottom:2px solid #333;padding-bottom:8px;}
    .verdict{font-size:22px;font-weight:bold;margin:16px 0;}
    .row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #eee;font-size:13px;}
    .label{color:#666;}
    .hash{font-family:monospace;font-size:11px;word-break:break-all;}
    .msg{background:#f5f5f5;padding:12px;border-radius:6px;font-size:13px;margin:12px 0;}
    .footer{margin-top:24px;font-size:11px;color:#999;text-align:center;}
  </style></head><body>
  <h1>${t.reportTitle}</h1>
  <div class="row"><span class="label">${t.reportEngine}</span></div>
  <div class="row"><span class="label">${t.reportPatterns}</span></div>
  <div class="row"><span class="label">${t.timeLabel}</span><span>${now}</span></div>
  <div class="verdict">${t.verdictEmoji[r.verdict]} ${t.verdictLabels[r.verdict]}</div>
  <div class="row"><span class="label">${t.reportConfidence}</span><span>${r.confidence}%</span></div>
  <div class="row"><span class="label">${t.reportTriggered}</span><span>${patterns}</span></div>
  <div class="row"><span class="label">${t.reportHash}</span><span class="hash">${r.proof_hash}</span></div>
  <div class="msg"><b>${lang === 'hi' ? '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§ø‡§§ ‡§∏‡§Ç‡§¶‡•á‡§∂:' : 'Analyzed Message:'}</b><br>${inputText}</div>
  <div class="footer">${t.reportFooter}</div>
  </body></html>`;

  const blob = new Blob([html], {type: 'text/html'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `veritas-report-${Date.now()}.html`;
  a.click();
  URL.revokeObjectURL(url);
}

function clearText() {
  document.getElementById('input-text').value = '';
  document.getElementById('char-val').textContent = '0';
  document.getElementById('result-card').style.display = 'none';
}

// Init
document.getElementById('btn-en').addEventListener('click', () => setLang('en'));
document.getElementById('btn-hi').addEventListener('click', () => setLang('hi'));
document.getElementById('analyze-btn').addEventListener('click', analyze);
applyLang();
updateStats();
</script>
</body>
</html>
